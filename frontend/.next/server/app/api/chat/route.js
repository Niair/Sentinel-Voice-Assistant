"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/chat/route";
exports.ids = ["app/api/chat/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("net");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("os");

/***/ }),

/***/ "perf_hooks":
/*!*****************************!*\
  !*** external "perf_hooks" ***!
  \*****************************/
/***/ ((module) => {

module.exports = require("perf_hooks");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("tls");

/***/ }),

/***/ "(rsc)/./node_modules/.pnpm/next@14.1.0_@opentelemetry+_95d5a05ac7ec0d735f17a907e734f3d8/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=E%3A%5C_Projects%5CSentinal-Voice-Assistant%5Cfrontend%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=E%3A%5C_Projects%5CSentinal-Voice-Assistant%5Cfrontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/next@14.1.0_@opentelemetry+_95d5a05ac7ec0d735f17a907e734f3d8/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=E%3A%5C_Projects%5CSentinal-Voice-Assistant%5Cfrontend%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=E%3A%5C_Projects%5CSentinal-Voice-Assistant%5Cfrontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/.pnpm/next@14.1.0_@opentelemetry+_95d5a05ac7ec0d735f17a907e734f3d8/node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/.pnpm/next@14.1.0_@opentelemetry+_95d5a05ac7ec0d735f17a907e734f3d8/node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/.pnpm/next@14.1.0_@opentelemetry+_95d5a05ac7ec0d735f17a907e734f3d8/node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var E_Projects_Sentinal_Voice_Assistant_frontend_app_api_chat_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/chat/route.ts */ \"(rsc)/./app/api/chat/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/chat/route\",\n        pathname: \"/api/chat\",\n        filename: \"route\",\n        bundlePath: \"app/api/chat/route\"\n    },\n    resolvedPagePath: \"E:\\\\_Projects\\\\Sentinal-Voice-Assistant\\\\frontend\\\\app\\\\api\\\\chat\\\\route.ts\",\n    nextConfigOutput,\n    userland: E_Projects_Sentinal_Voice_Assistant_frontend_app_api_chat_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/chat/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvLnBucG0vbmV4dEAxNC4xLjBfQG9wZW50ZWxlbWV0cnkrXzk1ZDVhMDVhYzdlYzBkNzM1ZjE3YTkwN2U3MzRmM2Q4L25vZGVfbW9kdWxlcy9uZXh0L2Rpc3QvYnVpbGQvd2VicGFjay9sb2FkZXJzL25leHQtYXBwLWxvYWRlci5qcz9uYW1lPWFwcCUyRmFwaSUyRmNoYXQlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmNoYXQlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZjaGF0JTJGcm91dGUudHMmYXBwRGlyPUUlM0ElNUNfUHJvamVjdHMlNUNTZW50aW5hbC1Wb2ljZS1Bc3Npc3RhbnQlNUNmcm9udGVuZCU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9RSUzQSU1Q19Qcm9qZWN0cyU1Q1NlbnRpbmFsLVZvaWNlLUFzc2lzdGFudCU1Q2Zyb250ZW5kJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQzJCO0FBQ3hHO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsdUdBQXVHO0FBQy9HO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDNko7O0FBRTdKIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VudGluZWwtZnJvbnRlbmQvP2Q4NzgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiRTpcXFxcX1Byb2plY3RzXFxcXFNlbnRpbmFsLVZvaWNlLUFzc2lzdGFudFxcXFxmcm9udGVuZFxcXFxhcHBcXFxcYXBpXFxcXGNoYXRcXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2NoYXQvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9jaGF0XCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9jaGF0L3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiRTpcXFxcX1Byb2plY3RzXFxcXFNlbnRpbmFsLVZvaWNlLUFzc2lzdGFudFxcXFxmcm9udGVuZFxcXFxhcHBcXFxcYXBpXFxcXGNoYXRcXFxccm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgaGVhZGVySG9va3MsIHN0YXRpY0dlbmVyYXRpb25CYWlsb3V0IH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvY2hhdC9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBoZWFkZXJIb29rcywgc3RhdGljR2VuZXJhdGlvbkJhaWxvdXQsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/.pnpm/next@14.1.0_@opentelemetry+_95d5a05ac7ec0d735f17a907e734f3d8/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=E%3A%5C_Projects%5CSentinal-Voice-Assistant%5Cfrontend%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=E%3A%5C_Projects%5CSentinal-Voice-Assistant%5Cfrontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/chat/route.ts":
/*!*******************************!*\
  !*** ./app/api/chat/route.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var _lib_db_queries__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/db/queries */ \"(rsc)/./lib/db/queries.ts\");\n/* harmony import */ var _lib_utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/utils */ \"(rsc)/./lib/utils.ts\");\n\n\nfunction getMessageText(message) {\n    return String((0,_lib_utils__WEBPACK_IMPORTED_MODULE_1__.getTextFromMessage)(message) || message.content || \"\");\n}\nasync function saveMessageIfMissing(message, chatId) {\n    const messageId = message.id || (0,_lib_utils__WEBPACK_IMPORTED_MODULE_1__.generateUUID)();\n    if (message.id) {\n        const existing = await (0,_lib_db_queries__WEBPACK_IMPORTED_MODULE_0__.getMessageById)({\n            id: message.id\n        });\n        if (existing.length > 0) {\n            return;\n        }\n    }\n    const text = getMessageText(message);\n    await (0,_lib_db_queries__WEBPACK_IMPORTED_MODULE_0__.saveMessages)({\n        messages: [\n            {\n                id: messageId,\n                chatId,\n                role: message.role,\n                parts: message.parts || [\n                    {\n                        type: \"text\",\n                        text\n                    }\n                ],\n                attachments: message.attachments || [],\n                createdAt: new Date()\n            }\n        ]\n    });\n}\n// FIXED: Simplified stream parser that correctly handles Vercel AI SDK format\nasync function collectAssistantData(stream) {\n    const reader = stream.getReader();\n    const decoder = new TextDecoder();\n    let buffer = \"\";\n    let text = \"\";\n    try {\n        while(true){\n            const { done, value } = await reader.read();\n            if (done) break;\n            buffer += decoder.decode(value, {\n                stream: true\n            });\n            let newlineIndex = buffer.indexOf(\"\\n\");\n            while(newlineIndex !== -1){\n                const line = buffer.slice(0, newlineIndex);\n                buffer = buffer.slice(newlineIndex + 1);\n                // Parse Vercel AI SDK streaming format\n                if (line.startsWith(\"0:\")) {\n                    const payload = line.slice(2).trim();\n                    try {\n                        const parsed = JSON.parse(payload);\n                        // Handle both string and object formats\n                        if (typeof parsed === \"string\") {\n                            text += parsed;\n                        } else if (parsed?.content) {\n                            text += parsed.content;\n                        }\n                    } catch  {\n                        // Fallback for unescaped strings\n                        text += payload.replace(/^\"|\"$/g, \"\");\n                    }\n                }\n                newlineIndex = buffer.indexOf(\"\\n\");\n            }\n        }\n        // Handle any remaining buffer\n        if (buffer.trim()) {\n            if (buffer.startsWith(\"0:\")) {\n                const payload = buffer.slice(2).trim();\n                text += payload.replace(/^\"|\"$/g, \"\");\n            }\n        }\n    } catch (error) {\n        console.error(\"Stream reading error:\", error);\n        text = \"I encountered an error while reading the response. Please try again.\";\n    }\n    return {\n        text\n    };\n}\nasync function POST(req) {\n    const { messages, id, selectedChatModel } = await req.json();\n    const userId = \"00000000-0000-0000-0000-000000000000\";\n    // Extract first USER message for title\n    const firstUserMessage = messages.find((m)=>m.role === \"user\");\n    const titleFromUser = firstUserMessage ? getMessageText(firstUserMessage).slice(0, 50) : \"New Chat\";\n    // FIXED: Declare chatExists at function scope so it's accessible in the async callback\n    let chatExists = false;\n    try {\n        await (0,_lib_db_queries__WEBPACK_IMPORTED_MODULE_0__.ensureGuestUserExists)(userId);\n        // Check if chat exists\n        const existingChat = await (0,_lib_db_queries__WEBPACK_IMPORTED_MODULE_0__.getChatById)({\n            id\n        });\n        chatExists = !!existingChat;\n        if (!chatExists && messages.length > 0) {\n            console.log(\"Saving new chat metadata for ID:\", id);\n            await (0,_lib_db_queries__WEBPACK_IMPORTED_MODULE_0__.saveChat)({\n                id,\n                userId,\n                title: titleFromUser,\n                visibility: \"private\"\n            });\n            await saveMessageIfMissing(firstUserMessage || messages[0], id);\n            console.log(\"Chat and first message saved successfully\");\n        } else {\n            const latestUserMessage = [\n                ...messages\n            ].reverse().find((message)=>message.role === \"user\");\n            if (latestUserMessage) {\n                await saveMessageIfMissing(latestUserMessage, id);\n            }\n        }\n    } catch (error) {\n        console.error(\"DATABASE ERROR in /api/chat (persistence check):\", error);\n    }\n    // Send attachments to backend\n    const messagesWithAttachments = messages.map((m)=>{\n        const baseMessage = {\n            role: m.role,\n            content: String((0,_lib_utils__WEBPACK_IMPORTED_MODULE_1__.getTextFromMessage)(m) || m.content || \"\"),\n            id: m.id\n        };\n        if (m.parts) {\n            const fileParts = m.parts.filter((p)=>p.type === \"file\");\n            if (fileParts.length > 0) {\n                baseMessage.attachments = fileParts;\n            }\n        }\n        return baseMessage;\n    });\n    const response = await fetch(\"http://127.0.0.1:8000/api/chat\", {\n        method: \"POST\",\n        headers: {\n            \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n            messages: messagesWithAttachments,\n            id: id,\n            user_id: userId,\n            model: selectedChatModel\n        })\n    });\n    if (!response.ok || !response.body) {\n        const errorText = await response.text().catch(()=>\"No error body\");\n        console.error(\"AI Backend error status:\", response.status, errorText);\n        return new Response(`AI backend error: ${response.status}`, {\n            status: 500\n        });\n    }\n    console.log(\"Got successful response from AI backend, piping stream for ID:\", id);\n    // Split stream for client response and background processing\n    const [clientStream, storageStream] = response.body.tee();\n    // Process assistant response in background\n    void (async ()=>{\n        try {\n            const { text } = await collectAssistantData(storageStream);\n            // Only update title if it's a new chat (chatExists is now properly scoped)\n            if (!chatExists && titleFromUser) {\n                console.log(\"Updating chat title to:\", titleFromUser);\n                await (0,_lib_db_queries__WEBPACK_IMPORTED_MODULE_0__.updateChatTitleById)({\n                    chatId: id,\n                    title: titleFromUser\n                });\n            }\n            if (text.trim()) {\n                await (0,_lib_db_queries__WEBPACK_IMPORTED_MODULE_0__.saveMessages)({\n                    messages: [\n                        {\n                            id: (0,_lib_utils__WEBPACK_IMPORTED_MODULE_1__.generateUUID)(),\n                            chatId: id,\n                            role: \"assistant\",\n                            parts: [\n                                {\n                                    type: \"text\",\n                                    text\n                                }\n                            ],\n                            attachments: [],\n                            createdAt: new Date()\n                        }\n                    ]\n                });\n            }\n        } catch (error) {\n            console.error(\"DATABASE ERROR in /api/chat (assistant save):\", error);\n        }\n    })();\n    return new Response(clientStream, {\n        headers: {\n            \"Content-Type\": \"text/plain; charset=utf-8\",\n            \"Cache-Control\": \"no-cache, no-transform\",\n            \"Connection\": \"keep-alive\",\n            \"X-Content-Type-Options\": \"nosniff\",\n            \"X-Vercel-AI-Data-Stream\": \"v1\"\n        }\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0FBQywyQkFBMkJIO2dCQUN2QyxNQUFNckQsb0VBQW1CQSxDQUFDO29CQUFFUSxRQUFRRTtvQkFBSStDLE9BQU9KO2dCQUFjO1lBQy9EO1lBRUEsSUFBSXhDLEtBQUt5QixJQUFJLElBQUk7Z0JBQ2YsTUFBTXhDLDZEQUFZQSxDQUFDO29CQUNqQmdCLFVBQVU7d0JBQUM7NEJBQ1RKLElBQUlULHdEQUFZQTs0QkFDaEJPLFFBQVFFOzRCQUNSSyxNQUFNOzRCQUNOQyxPQUFPO2dDQUFDO29DQUFFQyxNQUFNO29DQUFRSjtnQ0FBSzs2QkFBRTs0QkFDL0JLLGFBQWEsRUFBRTs0QkFDZkMsV0FBVyxJQUFJQzt3QkFDakI7cUJBQUU7Z0JBQ0o7WUFDRjtRQUNGLEVBQUUsT0FBT3VCLE9BQU87WUFDZEMsUUFBUUQsS0FBSyxDQUFDLGlEQUFpREE7UUFDakU7SUFDRjtJQUVBLE9BQU8sSUFBSW9DLFNBQVNDLGNBQWM7UUFDaENWLFNBQVM7WUFDUCxnQkFBZ0I7WUFDaEIsaUJBQWlCO1lBQ2pCLGNBQWM7WUFDZCwwQkFBMEI7WUFDMUIsMkJBQTJCO1FBQzdCO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3NlbnRpbmVsLWZyb250ZW5kLy4vYXBwL2FwaS9jaGF0L3JvdXRlLnRzP2RlNDYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZ2V0Q2hhdEJ5SWQsIGdldE1lc3NhZ2VCeUlkLCBzYXZlQ2hhdCwgc2F2ZU1lc3NhZ2VzLCBlbnN1cmVHdWVzdFVzZXJFeGlzdHMsIHVwZGF0ZUNoYXRUaXRsZUJ5SWQgfSBmcm9tICdAL2xpYi9kYi9xdWVyaWVzJztcbmltcG9ydCB7IGdlbmVyYXRlVVVJRCwgZ2V0VGV4dEZyb21NZXNzYWdlIH0gZnJvbSAnQC9saWIvdXRpbHMnO1xuaW1wb3J0IHsgTWVzc2FnZSB9IGZyb20gJ2FpJztcblxuZnVuY3Rpb24gZ2V0TWVzc2FnZVRleHQobWVzc2FnZTogTWVzc2FnZSkge1xuICByZXR1cm4gU3RyaW5nKGdldFRleHRGcm9tTWVzc2FnZShtZXNzYWdlIGFzIGFueSkgfHwgbWVzc2FnZS5jb250ZW50IHx8ICcnKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gc2F2ZU1lc3NhZ2VJZk1pc3NpbmcobWVzc2FnZTogTWVzc2FnZSwgY2hhdElkOiBzdHJpbmcpIHtcbiAgY29uc3QgbWVzc2FnZUlkID0gbWVzc2FnZS5pZCB8fCBnZW5lcmF0ZVVVSUQoKTtcbiAgaWYgKG1lc3NhZ2UuaWQpIHtcbiAgICBjb25zdCBleGlzdGluZyA9IGF3YWl0IGdldE1lc3NhZ2VCeUlkKHsgaWQ6IG1lc3NhZ2UuaWQgfSk7XG4gICAgaWYgKGV4aXN0aW5nLmxlbmd0aCA+IDApIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gIH1cblxuICBjb25zdCB0ZXh0ID0gZ2V0TWVzc2FnZVRleHQobWVzc2FnZSk7XG4gIGF3YWl0IHNhdmVNZXNzYWdlcyh7XG4gICAgbWVzc2FnZXM6IFt7XG4gICAgICBpZDogbWVzc2FnZUlkLFxuICAgICAgY2hhdElkLFxuICAgICAgcm9sZTogbWVzc2FnZS5yb2xlLFxuICAgICAgcGFydHM6IChtZXNzYWdlIGFzIGFueSkucGFydHMgfHwgW3sgdHlwZTogJ3RleHQnLCB0ZXh0IH1dLFxuICAgICAgYXR0YWNobWVudHM6IChtZXNzYWdlIGFzIGFueSkuYXR0YWNobWVudHMgfHwgW10sXG4gICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgfV1cbiAgfSk7XG59XG5cbi8vIEZJWEVEOiBTaW1wbGlmaWVkIHN0cmVhbSBwYXJzZXIgdGhhdCBjb3JyZWN0bHkgaGFuZGxlcyBWZXJjZWwgQUkgU0RLIGZvcm1hdFxuYXN5bmMgZnVuY3Rpb24gY29sbGVjdEFzc2lzdGFudERhdGEoc3RyZWFtOiBSZWFkYWJsZVN0cmVhbTxVaW50OEFycmF5Pikge1xuICBjb25zdCByZWFkZXIgPSBzdHJlYW0uZ2V0UmVhZGVyKCk7XG4gIGNvbnN0IGRlY29kZXIgPSBuZXcgVGV4dERlY29kZXIoKTtcbiAgbGV0IGJ1ZmZlciA9ICcnO1xuICBsZXQgdGV4dCA9ICcnO1xuXG4gIHRyeSB7XG4gICAgd2hpbGUgKHRydWUpIHtcbiAgICAgIGNvbnN0IHsgZG9uZSwgdmFsdWUgfSA9IGF3YWl0IHJlYWRlci5yZWFkKCk7XG4gICAgICBpZiAoZG9uZSkgYnJlYWs7XG5cbiAgICAgIGJ1ZmZlciArPSBkZWNvZGVyLmRlY29kZSh2YWx1ZSwgeyBzdHJlYW06IHRydWUgfSk7XG4gICAgICBsZXQgbmV3bGluZUluZGV4ID0gYnVmZmVyLmluZGV4T2YoJ1xcbicpO1xuXG4gICAgICB3aGlsZSAobmV3bGluZUluZGV4ICE9PSAtMSkge1xuICAgICAgICBjb25zdCBsaW5lID0gYnVmZmVyLnNsaWNlKDAsIG5ld2xpbmVJbmRleCk7XG4gICAgICAgIGJ1ZmZlciA9IGJ1ZmZlci5zbGljZShuZXdsaW5lSW5kZXggKyAxKTtcblxuICAgICAgICAvLyBQYXJzZSBWZXJjZWwgQUkgU0RLIHN0cmVhbWluZyBmb3JtYXRcbiAgICAgICAgaWYgKGxpbmUuc3RhcnRzV2l0aCgnMDonKSkge1xuICAgICAgICAgIGNvbnN0IHBheWxvYWQgPSBsaW5lLnNsaWNlKDIpLnRyaW0oKTtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcGFyc2VkID0gSlNPTi5wYXJzZShwYXlsb2FkKTtcbiAgICAgICAgICAgIC8vIEhhbmRsZSBib3RoIHN0cmluZyBhbmQgb2JqZWN0IGZvcm1hdHNcbiAgICAgICAgICAgIGlmICh0eXBlb2YgcGFyc2VkID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICB0ZXh0ICs9IHBhcnNlZDtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocGFyc2VkPy5jb250ZW50KSB7XG4gICAgICAgICAgICAgIHRleHQgKz0gcGFyc2VkLmNvbnRlbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICAvLyBGYWxsYmFjayBmb3IgdW5lc2NhcGVkIHN0cmluZ3NcbiAgICAgICAgICAgIHRleHQgKz0gcGF5bG9hZC5yZXBsYWNlKC9eXCJ8XCIkL2csICcnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBuZXdsaW5lSW5kZXggPSBidWZmZXIuaW5kZXhPZignXFxuJyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gSGFuZGxlIGFueSByZW1haW5pbmcgYnVmZmVyXG4gICAgaWYgKGJ1ZmZlci50cmltKCkpIHtcbiAgICAgIGlmIChidWZmZXIuc3RhcnRzV2l0aCgnMDonKSkge1xuICAgICAgICBjb25zdCBwYXlsb2FkID0gYnVmZmVyLnNsaWNlKDIpLnRyaW0oKTtcbiAgICAgICAgdGV4dCArPSBwYXlsb2FkLnJlcGxhY2UoL15cInxcIiQvZywgJycpO1xuICAgICAgfVxuICAgIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdTdHJlYW0gcmVhZGluZyBlcnJvcjonLCBlcnJvcik7XG4gICAgdGV4dCA9IFwiSSBlbmNvdW50ZXJlZCBhbiBlcnJvciB3aGlsZSByZWFkaW5nIHRoZSByZXNwb25zZS4gUGxlYXNlIHRyeSBhZ2Fpbi5cIjtcbiAgfVxuXG4gIHJldHVybiB7IHRleHQgfTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxOiBSZXF1ZXN0KSB7XG4gIGNvbnN0IHsgbWVzc2FnZXMsIGlkLCBzZWxlY3RlZENoYXRNb2RlbCB9OiB7IG1lc3NhZ2VzOiBBcnJheTxNZXNzYWdlPiwgaWQ6IHN0cmluZywgc2VsZWN0ZWRDaGF0TW9kZWw/OiBzdHJpbmcgfSA9IGF3YWl0IHJlcS5qc29uKCk7XG4gIGNvbnN0IHVzZXJJZCA9ICcwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDAnO1xuXG4gIC8vIEV4dHJhY3QgZmlyc3QgVVNFUiBtZXNzYWdlIGZvciB0aXRsZVxuICBjb25zdCBmaXJzdFVzZXJNZXNzYWdlID0gbWVzc2FnZXMuZmluZChtID0+IG0ucm9sZSA9PT0gJ3VzZXInKTtcbiAgY29uc3QgdGl0bGVGcm9tVXNlciA9IGZpcnN0VXNlck1lc3NhZ2UgPyBnZXRNZXNzYWdlVGV4dChmaXJzdFVzZXJNZXNzYWdlKS5zbGljZSgwLCA1MCkgOiAnTmV3IENoYXQnO1xuXG4gIC8vIEZJWEVEOiBEZWNsYXJlIGNoYXRFeGlzdHMgYXQgZnVuY3Rpb24gc2NvcGUgc28gaXQncyBhY2Nlc3NpYmxlIGluIHRoZSBhc3luYyBjYWxsYmFja1xuICBsZXQgY2hhdEV4aXN0cyA9IGZhbHNlO1xuXG4gIHRyeSB7XG4gICAgYXdhaXQgZW5zdXJlR3Vlc3RVc2VyRXhpc3RzKHVzZXJJZCk7XG5cbiAgICAvLyBDaGVjayBpZiBjaGF0IGV4aXN0c1xuICAgIGNvbnN0IGV4aXN0aW5nQ2hhdCA9IGF3YWl0IGdldENoYXRCeUlkKHsgaWQgfSk7XG4gICAgY2hhdEV4aXN0cyA9ICEhZXhpc3RpbmdDaGF0O1xuXG4gICAgaWYgKCFjaGF0RXhpc3RzICYmIG1lc3NhZ2VzLmxlbmd0aCA+IDApIHtcbiAgICAgIGNvbnNvbGUubG9nKCdTYXZpbmcgbmV3IGNoYXQgbWV0YWRhdGEgZm9yIElEOicsIGlkKTtcbiAgICAgIGF3YWl0IHNhdmVDaGF0KHtcbiAgICAgICAgaWQsXG4gICAgICAgIHVzZXJJZCxcbiAgICAgICAgdGl0bGU6IHRpdGxlRnJvbVVzZXIsXG4gICAgICAgIHZpc2liaWxpdHk6ICdwcml2YXRlJ1xuICAgICAgfSk7XG5cbiAgICAgIGF3YWl0IHNhdmVNZXNzYWdlSWZNaXNzaW5nKGZpcnN0VXNlck1lc3NhZ2UgfHwgbWVzc2FnZXNbMF0sIGlkKTtcbiAgICAgIGNvbnNvbGUubG9nKCdDaGF0IGFuZCBmaXJzdCBtZXNzYWdlIHNhdmVkIHN1Y2Nlc3NmdWxseScpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBsYXRlc3RVc2VyTWVzc2FnZSA9IFsuLi5tZXNzYWdlc10ucmV2ZXJzZSgpLmZpbmQoKG1lc3NhZ2UpID0+IG1lc3NhZ2Uucm9sZSA9PT0gJ3VzZXInKTtcbiAgICAgIGlmIChsYXRlc3RVc2VyTWVzc2FnZSkge1xuICAgICAgICBhd2FpdCBzYXZlTWVzc2FnZUlmTWlzc2luZyhsYXRlc3RVc2VyTWVzc2FnZSwgaWQpO1xuICAgICAgfVxuICAgIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdEQVRBQkFTRSBFUlJPUiBpbiAvYXBpL2NoYXQgKHBlcnNpc3RlbmNlIGNoZWNrKTonLCBlcnJvcik7XG4gIH1cblxuICAvLyBTZW5kIGF0dGFjaG1lbnRzIHRvIGJhY2tlbmRcbiAgY29uc3QgbWVzc2FnZXNXaXRoQXR0YWNobWVudHMgPSBtZXNzYWdlcy5tYXAobSA9PiB7XG4gICAgY29uc3QgYmFzZU1lc3NhZ2UgPSB7XG4gICAgICByb2xlOiBtLnJvbGUsXG4gICAgICBjb250ZW50OiBTdHJpbmcoZ2V0VGV4dEZyb21NZXNzYWdlKG0gYXMgYW55KSB8fCBtLmNvbnRlbnQgfHwgJycpLFxuICAgICAgaWQ6IG0uaWRcbiAgICB9O1xuXG4gICAgaWYgKChtIGFzIGFueSkucGFydHMpIHtcbiAgICAgIGNvbnN0IGZpbGVQYXJ0cyA9IChtIGFzIGFueSkucGFydHMuZmlsdGVyKChwOiBhbnkpID0+IHAudHlwZSA9PT0gJ2ZpbGUnKTtcbiAgICAgIGlmIChmaWxlUGFydHMubGVuZ3RoID4gMCkge1xuICAgICAgICAoYmFzZU1lc3NhZ2UgYXMgYW55KS5hdHRhY2htZW50cyA9IGZpbGVQYXJ0cztcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gYmFzZU1lc3NhZ2U7XG4gIH0pO1xuXG4gIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJ2h0dHA6Ly8xMjcuMC4wLjE6ODAwMC9hcGkvY2hhdCcsIHtcbiAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSxcbiAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICBtZXNzYWdlczogbWVzc2FnZXNXaXRoQXR0YWNobWVudHMsXG4gICAgICBpZDogaWQsXG4gICAgICB1c2VyX2lkOiB1c2VySWQsXG4gICAgICBtb2RlbDogc2VsZWN0ZWRDaGF0TW9kZWxcbiAgICB9KSxcbiAgfSk7XG5cbiAgaWYgKCFyZXNwb25zZS5vayB8fCAhcmVzcG9uc2UuYm9keSkge1xuICAgIGNvbnN0IGVycm9yVGV4dCA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKS5jYXRjaCgoKSA9PiAnTm8gZXJyb3IgYm9keScpO1xuICAgIGNvbnNvbGUuZXJyb3IoJ0FJIEJhY2tlbmQgZXJyb3Igc3RhdHVzOicsIHJlc3BvbnNlLnN0YXR1cywgZXJyb3JUZXh0KTtcbiAgICByZXR1cm4gbmV3IFJlc3BvbnNlKGBBSSBiYWNrZW5kIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c31gLCB7IHN0YXR1czogNTAwIH0pO1xuICB9XG5cbiAgY29uc29sZS5sb2coJ0dvdCBzdWNjZXNzZnVsIHJlc3BvbnNlIGZyb20gQUkgYmFja2VuZCwgcGlwaW5nIHN0cmVhbSBmb3IgSUQ6JywgaWQpO1xuXG4gIC8vIFNwbGl0IHN0cmVhbSBmb3IgY2xpZW50IHJlc3BvbnNlIGFuZCBiYWNrZ3JvdW5kIHByb2Nlc3NpbmdcbiAgY29uc3QgW2NsaWVudFN0cmVhbSwgc3RvcmFnZVN0cmVhbV0gPSByZXNwb25zZS5ib2R5LnRlZSgpO1xuXG4gIC8vIFByb2Nlc3MgYXNzaXN0YW50IHJlc3BvbnNlIGluIGJhY2tncm91bmRcbiAgdm9pZCAoYXN5bmMgKCkgPT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IHRleHQgfSA9IGF3YWl0IGNvbGxlY3RBc3Npc3RhbnREYXRhKHN0b3JhZ2VTdHJlYW0pO1xuXG4gICAgICAvLyBPbmx5IHVwZGF0ZSB0aXRsZSBpZiBpdCdzIGEgbmV3IGNoYXQgKGNoYXRFeGlzdHMgaXMgbm93IHByb3Blcmx5IHNjb3BlZClcbiAgICAgIGlmICghY2hhdEV4aXN0cyAmJiB0aXRsZUZyb21Vc2VyKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdVcGRhdGluZyBjaGF0IHRpdGxlIHRvOicsIHRpdGxlRnJvbVVzZXIpO1xuICAgICAgICBhd2FpdCB1cGRhdGVDaGF0VGl0bGVCeUlkKHsgY2hhdElkOiBpZCwgdGl0bGU6IHRpdGxlRnJvbVVzZXIgfSk7XG4gICAgICB9XG5cbiAgICAgIGlmICh0ZXh0LnRyaW0oKSkge1xuICAgICAgICBhd2FpdCBzYXZlTWVzc2FnZXMoe1xuICAgICAgICAgIG1lc3NhZ2VzOiBbe1xuICAgICAgICAgICAgaWQ6IGdlbmVyYXRlVVVJRCgpLFxuICAgICAgICAgICAgY2hhdElkOiBpZCxcbiAgICAgICAgICAgIHJvbGU6ICdhc3Npc3RhbnQnLFxuICAgICAgICAgICAgcGFydHM6IFt7IHR5cGU6ICd0ZXh0JywgdGV4dCB9XSxcbiAgICAgICAgICAgIGF0dGFjaG1lbnRzOiBbXSxcbiAgICAgICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKSxcbiAgICAgICAgICB9XVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignREFUQUJBU0UgRVJST1IgaW4gL2FwaS9jaGF0IChhc3Npc3RhbnQgc2F2ZSk6JywgZXJyb3IpO1xuICAgIH1cbiAgfSkoKTtcblxuICByZXR1cm4gbmV3IFJlc3BvbnNlKGNsaWVudFN0cmVhbSwge1xuICAgIGhlYWRlcnM6IHtcbiAgICAgICdDb250ZW50LVR5cGUnOiAndGV4dC9wbGFpbjsgY2hhcnNldD11dGYtOCcsXG4gICAgICAnQ2FjaGUtQ29udHJvbCc6ICduby1jYWNoZSwgbm8tdHJhbnNmb3JtJyxcbiAgICAgICdDb25uZWN0aW9uJzogJ2tlZXAtYWxpdmUnLFxuICAgICAgJ1gtQ29udGVudC1UeXBlLU9wdGlvbnMnOiAnbm9zbmlmZicsXG4gICAgICAnWC1WZXJjZWwtQUktRGF0YS1TdHJlYW0nOiAndjEnLFxuICAgIH0sXG4gIH0pO1xufSJdLCJuYW1lcyI6WyJnZXRDaGF0QnlJZCIsImdldE1lc3NhZ2VCeUlkIiwic2F2ZUNoYXQiLCJzYXZlTWVzc2FnZXMiLCJlbnN1cmVHdWVzdFVzZXJFeGlzdHMiLCJ1cGRhdGVDaGF0VGl0bGVCeUlkIiwiZ2VuZXJhdGVVVUlEIiwiZ2V0VGV4dEZyb21NZXNzYWdlIiwiZ2V0TWVzc2FnZVRleHQiLCJtZXNzYWdlIiwiU3RyaW5nIiwiY29udGVudCIsInNhdmVNZXNzYWdlSWZNaXNzaW5nIiwiY2hhdElkIiwibWVzc2FnZUlkIiwiaWQiLCJleGlzdGluZyIsImxlbmd0aCIsInRleHQiLCJtZXNzYWdlcyIsInJvbGUiLCJwYXJ0cyIsInR5cGUiLCJhdHRhY2htZW50cyIsImNyZWF0ZWRBdCIsIkRhdGUiLCJjb2xsZWN0QXNzaXN0YW50RGF0YSIsInN0cmVhbSIsInJlYWRlciIsImdldFJlYWRlciIsImRlY29kZXIiLCJUZXh0RGVjb2RlciIsImJ1ZmZlciIsImRvbmUiLCJ2YWx1ZSIsInJlYWQiLCJkZWNvZGUiLCJuZXdsaW5lSW5kZXgiLCJpbmRleE9mIiwibGluZSIsInNsaWNlIiwic3RhcnRzV2l0aCIsInBheWxvYWQiLCJ0cmltIiwicGFyc2VkIiwiSlNPTiIsInBhcnNlIiwicmVwbGFjZSIsImVycm9yIiwiY29uc29sZSIsIlBPU1QiLCJyZXEiLCJzZWxlY3RlZENoYXRNb2RlbCIsImpzb24iLCJ1c2VySWQiLCJmaXJzdFVzZXJNZXNzYWdlIiwiZmluZCIsIm0iLCJ0aXRsZUZyb21Vc2VyIiwiY2hhdEV4aXN0cyIsImV4aXN0aW5nQ2hhdCIsImxvZyIsInRpdGxlIiwidmlzaWJpbGl0eSIsImxhdGVzdFVzZXJNZXNzYWdlIiwicmV2ZXJzZSIsIm1lc3NhZ2VzV2l0aEF0dGFjaG1lbnRzIiwibWFwIiwiYmFzZU1lc3NhZ2UiLCJmaWxlUGFydHMiLCJmaWx0ZXIiLCJwIiwicmVzcG9uc2UiLCJmZXRjaCIsIm1ldGhvZCIsImhlYWRlcnMiLCJib2R5Iiwic3RyaW5naWZ5IiwidXNlcl9pZCIsIm1vZGVsIiwib2siLCJlcnJvclRleHQiLCJjYXRjaCIsInN0YXR1cyIsIlJlc3BvbnNlIiwiY2xpZW50U3RyZWFtIiwic3RvcmFnZVN0cmVhbSIsInRlZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/chat/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/db/queries.ts":
/*!***************************!*\
  !*** ./lib/db/queries.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createGuestUser: () => (/* binding */ createGuestUser),\n/* harmony export */   createStreamId: () => (/* binding */ createStreamId),\n/* harmony export */   createUser: () => (/* binding */ createUser),\n/* harmony export */   deleteAllChatsByUserId: () => (/* binding */ deleteAllChatsByUserId),\n/* harmony export */   deleteChatById: () => (/* binding */ deleteChatById),\n/* harmony export */   deleteDocumentsByIdAfterTimestamp: () => (/* binding */ deleteDocumentsByIdAfterTimestamp),\n/* harmony export */   deleteMessagesByChatIdAfterTimestamp: () => (/* binding */ deleteMessagesByChatIdAfterTimestamp),\n/* harmony export */   ensureGuestUserExists: () => (/* binding */ ensureGuestUserExists),\n/* harmony export */   getChatById: () => (/* binding */ getChatById),\n/* harmony export */   getChatsByUserId: () => (/* binding */ getChatsByUserId),\n/* harmony export */   getDocumentById: () => (/* binding */ getDocumentById),\n/* harmony export */   getDocumentsById: () => (/* binding */ getDocumentsById),\n/* harmony export */   getMessageById: () => (/* binding */ getMessageById),\n/* harmony export */   getMessageCountByUserId: () => (/* binding */ getMessageCountByUserId),\n/* harmony export */   getMessagesByChatId: () => (/* binding */ getMessagesByChatId),\n/* harmony export */   getStreamIdsByChatId: () => (/* binding */ getStreamIdsByChatId),\n/* harmony export */   getSuggestionsByDocumentId: () => (/* binding */ getSuggestionsByDocumentId),\n/* harmony export */   getUser: () => (/* binding */ getUser),\n/* harmony export */   getVotesByChatId: () => (/* binding */ getVotesByChatId),\n/* harmony export */   saveChat: () => (/* binding */ saveChat),\n/* harmony export */   saveDocument: () => (/* binding */ saveDocument),\n/* harmony export */   saveMessages: () => (/* binding */ saveMessages),\n/* harmony export */   saveSuggestions: () => (/* binding */ saveSuggestions),\n/* harmony export */   updateChatTitleById: () => (/* binding */ updateChatTitleById),\n/* harmony export */   updateChatVisibilityById: () => (/* binding */ updateChatVisibilityById),\n/* harmony export */   updateMessage: () => (/* binding */ updateMessage),\n/* harmony export */   voteMessage: () => (/* binding */ voteMessage)\n/* harmony export */ });\n/* harmony import */ var server_only__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! server-only */ \"(rsc)/./node_modules/.pnpm/next@14.1.0_@opentelemetry+_95d5a05ac7ec0d735f17a907e734f3d8/node_modules/next/dist/compiled/server-only/empty.js\");\n/* harmony import */ var server_only__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(server_only__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var drizzle_orm__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! drizzle-orm */ \"(rsc)/./node_modules/.pnpm/drizzle-orm@0.45.1_@opentelemetry+api@1.9.0_postgres@3.4.8/node_modules/drizzle-orm/sql/expressions/conditions.js\");\n/* harmony import */ var drizzle_orm__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! drizzle-orm */ \"(rsc)/./node_modules/.pnpm/drizzle-orm@0.45.1_@opentelemetry+api@1.9.0_postgres@3.4.8/node_modules/drizzle-orm/sql/expressions/select.js\");\n/* harmony import */ var drizzle_orm__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! drizzle-orm */ \"(rsc)/./node_modules/.pnpm/drizzle-orm@0.45.1_@opentelemetry+api@1.9.0_postgres@3.4.8/node_modules/drizzle-orm/sql/functions/aggregate.js\");\n/* harmony import */ var drizzle_orm_postgres_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! drizzle-orm/postgres-js */ \"(rsc)/./node_modules/.pnpm/drizzle-orm@0.45.1_@opentelemetry+api@1.9.0_postgres@3.4.8/node_modules/drizzle-orm/postgres-js/driver.js\");\n/* harmony import */ var postgres__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! postgres */ \"(rsc)/./node_modules/.pnpm/postgres@3.4.8/node_modules/postgres/src/index.js\");\n/* harmony import */ var _errors__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../errors */ \"(rsc)/./lib/errors.ts\");\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../utils */ \"(rsc)/./lib/utils.ts\");\n/* harmony import */ var _schema__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./schema */ \"(rsc)/./lib/db/schema.ts\");\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./utils */ \"(rsc)/./lib/db/utils.ts\");\n\n\n\n\n\n\n\n\n// Optionally, if not using email/pass login, you can\n// use the Drizzle adapter for Auth.js / NextAuth\n// https://authjs.dev/reference/adapter/drizzle\n// biome-ignore lint: Forbidden non-null assertion.\nconst client = (0,postgres__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(process.env.POSTGRES_URL);\nconst db = (0,drizzle_orm_postgres_js__WEBPACK_IMPORTED_MODULE_6__.drizzle)(client);\nasync function getUser(email) {\n    try {\n        return await db.select().from(_schema__WEBPACK_IMPORTED_MODULE_4__.user).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.eq)(_schema__WEBPACK_IMPORTED_MODULE_4__.user.email, email));\n    } catch (_error) {\n        throw new _errors__WEBPACK_IMPORTED_MODULE_2__.ChatSDKError(\"bad_request:database\", \"Failed to get user by email\");\n    }\n}\nasync function createUser(email, password) {\n    const hashedPassword = (0,_utils__WEBPACK_IMPORTED_MODULE_5__.generateHashedPassword)(password);\n    try {\n        return await db.insert(_schema__WEBPACK_IMPORTED_MODULE_4__.user).values({\n            email,\n            password: hashedPassword\n        });\n    } catch (_error) {\n        throw new _errors__WEBPACK_IMPORTED_MODULE_2__.ChatSDKError(\"bad_request:database\", \"Failed to create user\");\n    }\n}\nasync function createGuestUser() {\n    const email = `guest-${Date.now()}`;\n    const password = (0,_utils__WEBPACK_IMPORTED_MODULE_5__.generateHashedPassword)((0,_utils__WEBPACK_IMPORTED_MODULE_3__.generateUUID)());\n    try {\n        return await db.insert(_schema__WEBPACK_IMPORTED_MODULE_4__.user).values({\n            email,\n            password\n        }).returning({\n            id: _schema__WEBPACK_IMPORTED_MODULE_4__.user.id,\n            email: _schema__WEBPACK_IMPORTED_MODULE_4__.user.email\n        });\n    } catch (_error) {\n        throw new _errors__WEBPACK_IMPORTED_MODULE_2__.ChatSDKError(\"bad_request:database\", \"Failed to create guest user\");\n    }\n}\nasync function saveChat({ id, userId, title, visibility }) {\n    try {\n        return await db.insert(_schema__WEBPACK_IMPORTED_MODULE_4__.chat).values({\n            id,\n            createdAt: new Date(),\n            userId,\n            title,\n            visibility\n        });\n    } catch (_error) {\n        throw new _errors__WEBPACK_IMPORTED_MODULE_2__.ChatSDKError(\"bad_request:database\", \"Failed to save chat\");\n    }\n}\nasync function deleteChatById({ id }) {\n    try {\n        await db.delete(_schema__WEBPACK_IMPORTED_MODULE_4__.vote).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.eq)(_schema__WEBPACK_IMPORTED_MODULE_4__.vote.chatId, id));\n        await db.delete(_schema__WEBPACK_IMPORTED_MODULE_4__.message).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.eq)(_schema__WEBPACK_IMPORTED_MODULE_4__.message.chatId, id));\n        await db.delete(_schema__WEBPACK_IMPORTED_MODULE_4__.stream).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.eq)(_schema__WEBPACK_IMPORTED_MODULE_4__.stream.chatId, id));\n        const [chatsDeleted] = await db.delete(_schema__WEBPACK_IMPORTED_MODULE_4__.chat).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.eq)(_schema__WEBPACK_IMPORTED_MODULE_4__.chat.id, id)).returning();\n        return chatsDeleted;\n    } catch (_error) {\n        throw new _errors__WEBPACK_IMPORTED_MODULE_2__.ChatSDKError(\"bad_request:database\", \"Failed to delete chat by id\");\n    }\n}\nasync function deleteAllChatsByUserId({ userId }) {\n    try {\n        const userChats = await db.select({\n            id: _schema__WEBPACK_IMPORTED_MODULE_4__.chat.id\n        }).from(_schema__WEBPACK_IMPORTED_MODULE_4__.chat).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.eq)(_schema__WEBPACK_IMPORTED_MODULE_4__.chat.userId, userId));\n        if (userChats.length === 0) {\n            return {\n                deletedCount: 0\n            };\n        }\n        const chatIds = userChats.map((c)=>c.id);\n        await db.delete(_schema__WEBPACK_IMPORTED_MODULE_4__.vote).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.inArray)(_schema__WEBPACK_IMPORTED_MODULE_4__.vote.chatId, chatIds));\n        await db.delete(_schema__WEBPACK_IMPORTED_MODULE_4__.message).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.inArray)(_schema__WEBPACK_IMPORTED_MODULE_4__.message.chatId, chatIds));\n        await db.delete(_schema__WEBPACK_IMPORTED_MODULE_4__.stream).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.inArray)(_schema__WEBPACK_IMPORTED_MODULE_4__.stream.chatId, chatIds));\n        const deletedChats = await db.delete(_schema__WEBPACK_IMPORTED_MODULE_4__.chat).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.eq)(_schema__WEBPACK_IMPORTED_MODULE_4__.chat.userId, userId)).returning();\n        return {\n            deletedCount: deletedChats.length\n        };\n    } catch (_error) {\n        throw new _errors__WEBPACK_IMPORTED_MODULE_2__.ChatSDKError(\"bad_request:database\", \"Failed to delete all chats by user id\");\n    }\n}\nasync function getChatsByUserId({ id, limit, startingAfter, endingBefore }) {\n    try {\n        const extendedLimit = limit + 1;\n        const query = (whereCondition)=>db.select().from(_schema__WEBPACK_IMPORTED_MODULE_4__.chat).where(whereCondition ? (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.and)(whereCondition, (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.eq)(_schema__WEBPACK_IMPORTED_MODULE_4__.chat.userId, id)) : (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.eq)(_schema__WEBPACK_IMPORTED_MODULE_4__.chat.userId, id)).orderBy((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_8__.desc)(_schema__WEBPACK_IMPORTED_MODULE_4__.chat.createdAt)).limit(extendedLimit);\n        let filteredChats = [];\n        if (startingAfter) {\n            const [selectedChat] = await db.select().from(_schema__WEBPACK_IMPORTED_MODULE_4__.chat).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.eq)(_schema__WEBPACK_IMPORTED_MODULE_4__.chat.id, startingAfter)).limit(1);\n            if (!selectedChat) {\n                throw new _errors__WEBPACK_IMPORTED_MODULE_2__.ChatSDKError(\"not_found:database\", `Chat with id ${startingAfter} not found`);\n            }\n            filteredChats = await query((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.gt)(_schema__WEBPACK_IMPORTED_MODULE_4__.chat.createdAt, selectedChat.createdAt));\n        } else if (endingBefore) {\n            const [selectedChat] = await db.select().from(_schema__WEBPACK_IMPORTED_MODULE_4__.chat).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.eq)(_schema__WEBPACK_IMPORTED_MODULE_4__.chat.id, endingBefore)).limit(1);\n            if (!selectedChat) {\n                throw new _errors__WEBPACK_IMPORTED_MODULE_2__.ChatSDKError(\"not_found:database\", `Chat with id ${endingBefore} not found`);\n            }\n            filteredChats = await query((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.lt)(_schema__WEBPACK_IMPORTED_MODULE_4__.chat.createdAt, selectedChat.createdAt));\n        } else {\n            filteredChats = await query();\n        }\n        const hasMore = filteredChats.length > limit;\n        return {\n            chats: hasMore ? filteredChats.slice(0, limit) : filteredChats,\n            hasMore\n        };\n    } catch (_error) {\n        throw new _errors__WEBPACK_IMPORTED_MODULE_2__.ChatSDKError(\"bad_request:database\", \"Failed to get chats by user id\");\n    }\n}\nasync function getChatById({ id }) {\n    try {\n        const [selectedChat] = await db.select().from(_schema__WEBPACK_IMPORTED_MODULE_4__.chat).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.eq)(_schema__WEBPACK_IMPORTED_MODULE_4__.chat.id, id));\n        if (!selectedChat) {\n            return null;\n        }\n        return selectedChat;\n    } catch (_error) {\n        throw new _errors__WEBPACK_IMPORTED_MODULE_2__.ChatSDKError(\"bad_request:database\", \"Failed to get chat by id\");\n    }\n}\nasync function saveMessages({ messages }) {\n    try {\n        return await db.insert(_schema__WEBPACK_IMPORTED_MODULE_4__.message).values(messages);\n    } catch (_error) {\n        throw new _errors__WEBPACK_IMPORTED_MODULE_2__.ChatSDKError(\"bad_request:database\", \"Failed to save messages\");\n    }\n}\nasync function updateMessage({ id, parts }) {\n    try {\n        return await db.update(_schema__WEBPACK_IMPORTED_MODULE_4__.message).set({\n            parts\n        }).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.eq)(_schema__WEBPACK_IMPORTED_MODULE_4__.message.id, id));\n    } catch (_error) {\n        throw new _errors__WEBPACK_IMPORTED_MODULE_2__.ChatSDKError(\"bad_request:database\", \"Failed to update message\");\n    }\n}\nasync function getMessagesByChatId({ id }) {\n    try {\n        return await db.select().from(_schema__WEBPACK_IMPORTED_MODULE_4__.message).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.eq)(_schema__WEBPACK_IMPORTED_MODULE_4__.message.chatId, id)).orderBy((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_8__.asc)(_schema__WEBPACK_IMPORTED_MODULE_4__.message.createdAt));\n    } catch (_error) {\n        throw new _errors__WEBPACK_IMPORTED_MODULE_2__.ChatSDKError(\"bad_request:database\", \"Failed to get messages by chat id\");\n    }\n}\nasync function voteMessage({ chatId, messageId, type }) {\n    try {\n        const [existingVote] = await db.select().from(_schema__WEBPACK_IMPORTED_MODULE_4__.vote).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.and)((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.eq)(_schema__WEBPACK_IMPORTED_MODULE_4__.vote.messageId, messageId)));\n        if (existingVote) {\n            return await db.update(_schema__WEBPACK_IMPORTED_MODULE_4__.vote).set({\n                isUpvoted: type === \"up\"\n            }).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.and)((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.eq)(_schema__WEBPACK_IMPORTED_MODULE_4__.vote.messageId, messageId), (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.eq)(_schema__WEBPACK_IMPORTED_MODULE_4__.vote.chatId, chatId)));\n        }\n        return await db.insert(_schema__WEBPACK_IMPORTED_MODULE_4__.vote).values({\n            chatId,\n            messageId,\n            isUpvoted: type === \"up\"\n        });\n    } catch (_error) {\n        throw new _errors__WEBPACK_IMPORTED_MODULE_2__.ChatSDKError(\"bad_request:database\", \"Failed to vote message\");\n    }\n}\nasync function getVotesByChatId({ id }) {\n    try {\n        return await db.select().from(_schema__WEBPACK_IMPORTED_MODULE_4__.vote).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.eq)(_schema__WEBPACK_IMPORTED_MODULE_4__.vote.chatId, id));\n    } catch (_error) {\n        throw new _errors__WEBPACK_IMPORTED_MODULE_2__.ChatSDKError(\"bad_request:database\", \"Failed to get votes by chat id\");\n    }\n}\nasync function saveDocument({ id, title, kind, content, userId }) {\n    try {\n        return await db.insert(_schema__WEBPACK_IMPORTED_MODULE_4__.document).values({\n            id,\n            title,\n            kind,\n            content,\n            userId,\n            createdAt: new Date()\n        }).returning();\n    } catch (_error) {\n        throw new _errors__WEBPACK_IMPORTED_MODULE_2__.ChatSDKError(\"bad_request:database\", \"Failed to save document\");\n    }\n}\nasync function getDocumentsById({ id }) {\n    try {\n        const documents = await db.select().from(_schema__WEBPACK_IMPORTED_MODULE_4__.document).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.eq)(_schema__WEBPACK_IMPORTED_MODULE_4__.document.id, id)).orderBy((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_8__.asc)(_schema__WEBPACK_IMPORTED_MODULE_4__.document.createdAt));\n        return documents;\n    } catch (_error) {\n        throw new _errors__WEBPACK_IMPORTED_MODULE_2__.ChatSDKError(\"bad_request:database\", \"Failed to get documents by id\");\n    }\n}\nasync function getDocumentById({ id }) {\n    try {\n        const [selectedDocument] = await db.select().from(_schema__WEBPACK_IMPORTED_MODULE_4__.document).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.eq)(_schema__WEBPACK_IMPORTED_MODULE_4__.document.id, id)).orderBy((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_8__.desc)(_schema__WEBPACK_IMPORTED_MODULE_4__.document.createdAt));\n        return selectedDocument;\n    } catch (_error) {\n        throw new _errors__WEBPACK_IMPORTED_MODULE_2__.ChatSDKError(\"bad_request:database\", \"Failed to get document by id\");\n    }\n}\nasync function deleteDocumentsByIdAfterTimestamp({ id, timestamp }) {\n    try {\n        await db.delete(_schema__WEBPACK_IMPORTED_MODULE_4__.suggestion).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.and)((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.eq)(_schema__WEBPACK_IMPORTED_MODULE_4__.suggestion.documentId, id), (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.gt)(_schema__WEBPACK_IMPORTED_MODULE_4__.suggestion.documentCreatedAt, timestamp)));\n        return await db.delete(_schema__WEBPACK_IMPORTED_MODULE_4__.document).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.and)((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.eq)(_schema__WEBPACK_IMPORTED_MODULE_4__.document.id, id), (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.gt)(_schema__WEBPACK_IMPORTED_MODULE_4__.document.createdAt, timestamp))).returning();\n    } catch (_error) {\n        throw new _errors__WEBPACK_IMPORTED_MODULE_2__.ChatSDKError(\"bad_request:database\", \"Failed to delete documents by id after timestamp\");\n    }\n}\nasync function saveSuggestions({ suggestions }) {\n    try {\n        return await db.insert(_schema__WEBPACK_IMPORTED_MODULE_4__.suggestion).values(suggestions);\n    } catch (_error) {\n        throw new _errors__WEBPACK_IMPORTED_MODULE_2__.ChatSDKError(\"bad_request:database\", \"Failed to save suggestions\");\n    }\n}\nasync function getSuggestionsByDocumentId({ documentId }) {\n    try {\n        return await db.select().from(_schema__WEBPACK_IMPORTED_MODULE_4__.suggestion).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.eq)(_schema__WEBPACK_IMPORTED_MODULE_4__.suggestion.documentId, documentId));\n    } catch (_error) {\n        throw new _errors__WEBPACK_IMPORTED_MODULE_2__.ChatSDKError(\"bad_request:database\", \"Failed to get suggestions by document id\");\n    }\n}\nasync function getMessageById({ id }) {\n    try {\n        return await db.select().from(_schema__WEBPACK_IMPORTED_MODULE_4__.message).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.eq)(_schema__WEBPACK_IMPORTED_MODULE_4__.message.id, id));\n    } catch (_error) {\n        throw new _errors__WEBPACK_IMPORTED_MODULE_2__.ChatSDKError(\"bad_request:database\", \"Failed to get message by id\");\n    }\n}\nasync function deleteMessagesByChatIdAfterTimestamp({ chatId, timestamp }) {\n    try {\n        const messagesToDelete = await db.select({\n            id: _schema__WEBPACK_IMPORTED_MODULE_4__.message.id\n        }).from(_schema__WEBPACK_IMPORTED_MODULE_4__.message).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.and)((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.eq)(_schema__WEBPACK_IMPORTED_MODULE_4__.message.chatId, chatId), (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.gte)(_schema__WEBPACK_IMPORTED_MODULE_4__.message.createdAt, timestamp)));\n        const messageIds = messagesToDelete.map((currentMessage)=>currentMessage.id);\n        if (messageIds.length > 0) {\n            await db.delete(_schema__WEBPACK_IMPORTED_MODULE_4__.vote).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.and)((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.eq)(_schema__WEBPACK_IMPORTED_MODULE_4__.vote.chatId, chatId), (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.inArray)(_schema__WEBPACK_IMPORTED_MODULE_4__.vote.messageId, messageIds)));\n            return await db.delete(_schema__WEBPACK_IMPORTED_MODULE_4__.message).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.and)((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.eq)(_schema__WEBPACK_IMPORTED_MODULE_4__.message.chatId, chatId), (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.inArray)(_schema__WEBPACK_IMPORTED_MODULE_4__.message.id, messageIds)));\n        }\n    } catch (_error) {\n        throw new _errors__WEBPACK_IMPORTED_MODULE_2__.ChatSDKError(\"bad_request:database\", \"Failed to delete messages by chat id after timestamp\");\n    }\n}\nasync function updateChatVisibilityById({ chatId, visibility }) {\n    try {\n        return await db.update(_schema__WEBPACK_IMPORTED_MODULE_4__.chat).set({\n            visibility\n        }).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.eq)(_schema__WEBPACK_IMPORTED_MODULE_4__.chat.id, chatId));\n    } catch (_error) {\n        throw new _errors__WEBPACK_IMPORTED_MODULE_2__.ChatSDKError(\"bad_request:database\", \"Failed to update chat visibility by id\");\n    }\n}\nasync function updateChatTitleById({ chatId, title }) {\n    try {\n        return await db.update(_schema__WEBPACK_IMPORTED_MODULE_4__.chat).set({\n            title\n        }).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.eq)(_schema__WEBPACK_IMPORTED_MODULE_4__.chat.id, chatId));\n    } catch (error) {\n        console.warn(\"Failed to update title for chat\", chatId, error);\n        return;\n    }\n}\nasync function getMessageCountByUserId({ id, differenceInHours }) {\n    try {\n        const twentyFourHoursAgo = new Date(Date.now() - differenceInHours * 60 * 60 * 1000);\n        const [stats] = await db.select({\n            count: (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_9__.count)(_schema__WEBPACK_IMPORTED_MODULE_4__.message.id)\n        }).from(_schema__WEBPACK_IMPORTED_MODULE_4__.message).innerJoin(_schema__WEBPACK_IMPORTED_MODULE_4__.chat, (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.eq)(_schema__WEBPACK_IMPORTED_MODULE_4__.message.chatId, _schema__WEBPACK_IMPORTED_MODULE_4__.chat.id)).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.and)((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.eq)(_schema__WEBPACK_IMPORTED_MODULE_4__.chat.userId, id), (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.gte)(_schema__WEBPACK_IMPORTED_MODULE_4__.message.createdAt, twentyFourHoursAgo), (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.eq)(_schema__WEBPACK_IMPORTED_MODULE_4__.message.role, \"user\"))).execute();\n        return stats?.count ?? 0;\n    } catch (_error) {\n        throw new _errors__WEBPACK_IMPORTED_MODULE_2__.ChatSDKError(\"bad_request:database\", \"Failed to get message count by user id\");\n    }\n}\nasync function createStreamId({ streamId, chatId }) {\n    try {\n        await db.insert(_schema__WEBPACK_IMPORTED_MODULE_4__.stream).values({\n            id: streamId,\n            chatId,\n            createdAt: new Date()\n        });\n    } catch (_error) {\n        throw new _errors__WEBPACK_IMPORTED_MODULE_2__.ChatSDKError(\"bad_request:database\", \"Failed to create stream id\");\n    }\n}\nasync function getStreamIdsByChatId({ chatId }) {\n    try {\n        const streamIds = await db.select({\n            id: _schema__WEBPACK_IMPORTED_MODULE_4__.stream.id\n        }).from(_schema__WEBPACK_IMPORTED_MODULE_4__.stream).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.eq)(_schema__WEBPACK_IMPORTED_MODULE_4__.stream.chatId, chatId)).orderBy((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_8__.asc)(_schema__WEBPACK_IMPORTED_MODULE_4__.stream.createdAt)).execute();\n        return streamIds.map(({ id })=>id);\n    } catch (_error) {\n        throw new _errors__WEBPACK_IMPORTED_MODULE_2__.ChatSDKError(\"bad_request:database\", \"Failed to get stream ids by chat id\");\n    }\n}\nasync function ensureGuestUserExists(id) {\n    try {\n        const [existingUser] = await db.select().from(_schema__WEBPACK_IMPORTED_MODULE_4__.user).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_7__.eq)(_schema__WEBPACK_IMPORTED_MODULE_4__.user.id, id));\n        if (!existingUser) {\n            console.log(\"Creating guest user:\", id);\n            await db.insert(_schema__WEBPACK_IMPORTED_MODULE_4__.user).values({\n                id,\n                email: \"guest@sentinel.local\"\n            });\n        }\n    } catch (error) {\n        console.error(\"Error ensuring guest user exists:\", error);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixFQUFFdEUsTUFBTSxFQUFzQjtJQUN2RSxJQUFJO1FBQ0YsTUFBTXVFLFlBQVksTUFBTS9GLEdBQ3JCRyxNQUFNLENBQUM7WUFBRWEsSUFBSXpCLDJDQUFNQSxDQUFDeUIsRUFBRTtRQUFDLEdBQ3ZCWixJQUFJLENBQUNiLDJDQUFNQSxFQUNYYyxLQUFLLENBQUMxQiwrQ0FBRUEsQ0FBQ1ksMkNBQU1BLENBQUNpQyxNQUFNLEVBQUVBLFNBQ3hCaUIsT0FBTyxDQUFDakUsZ0RBQUdBLENBQUNlLDJDQUFNQSxDQUFDOEIsU0FBUyxHQUM1QnNFLE9BQU87UUFFVixPQUFPSSxVQUFVaEUsR0FBRyxDQUFDLENBQUMsRUFBRWYsRUFBRSxFQUFFLEdBQUtBO0lBQ25DLEVBQUUsT0FBT1YsUUFBUTtRQUNmLE1BQU0sSUFBSXBCLGlEQUFZQSxDQUNwQix3QkFDQTtJQUVKO0FBQ0Y7QUFFTyxlQUFlOEcsc0JBQXNCaEYsRUFBVTtJQUNwRCxJQUFJO1FBQ0YsTUFBTSxDQUFDaUYsYUFBYSxHQUFHLE1BQU1qRyxHQUFHRyxNQUFNLEdBQUdDLElBQUksQ0FBQ1gseUNBQUlBLEVBQUVZLEtBQUssQ0FBQzFCLCtDQUFFQSxDQUFDYyx5Q0FBSUEsQ0FBQ3VCLEVBQUUsRUFBRUE7UUFDdEUsSUFBSSxDQUFDaUYsY0FBYztZQUNqQmQsUUFBUWUsR0FBRyxDQUFDLHdCQUF3QmxGO1lBQ3BDLE1BQU1oQixHQUFHVSxNQUFNLENBQUNqQix5Q0FBSUEsRUFBRWtCLE1BQU0sQ0FBQztnQkFDM0JLO2dCQUNBZCxPQUFPO1lBQ1Q7UUFDRjtJQUNGLEVBQUUsT0FBT2dGLE9BQU87UUFDZEMsUUFBUUQsS0FBSyxDQUFDLHFDQUFxQ0E7SUFDckQ7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3NlbnRpbmVsLWZyb250ZW5kLy4vbGliL2RiL3F1ZXJpZXMudHM/MmQ3ZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgXCJzZXJ2ZXItb25seVwiO1xuXG5pbXBvcnQge1xuICBhbmQsXG4gIGFzYyxcbiAgY291bnQsXG4gIGRlc2MsXG4gIGVxLFxuICBndCxcbiAgZ3RlLFxuICBpbkFycmF5LFxuICBsdCxcbiAgdHlwZSBTUUwsXG59IGZyb20gXCJkcml6emxlLW9ybVwiO1xuaW1wb3J0IHsgZHJpenpsZSB9IGZyb20gXCJkcml6emxlLW9ybS9wb3N0Z3Jlcy1qc1wiO1xuaW1wb3J0IHBvc3RncmVzIGZyb20gXCJwb3N0Z3Jlc1wiO1xuaW1wb3J0IHR5cGUgeyBBcnRpZmFjdEtpbmQgfSBmcm9tIFwiQC9jb21wb25lbnRzL2FydGlmYWN0XCI7XG5pbXBvcnQgdHlwZSB7IFZpc2liaWxpdHlUeXBlIH0gZnJvbSBcIkAvY29tcG9uZW50cy92aXNpYmlsaXR5LXNlbGVjdG9yXCI7XG5pbXBvcnQgeyBDaGF0U0RLRXJyb3IgfSBmcm9tIFwiLi4vZXJyb3JzXCI7XG5pbXBvcnQgeyBnZW5lcmF0ZVVVSUQgfSBmcm9tIFwiLi4vdXRpbHNcIjtcbmltcG9ydCB7XG4gIHR5cGUgQ2hhdCxcbiAgY2hhdCxcbiAgdHlwZSBEQk1lc3NhZ2UsXG4gIGRvY3VtZW50LFxuICBtZXNzYWdlLFxuICB0eXBlIFN1Z2dlc3Rpb24sXG4gIHN0cmVhbSxcbiAgc3VnZ2VzdGlvbixcbiAgdHlwZSBVc2VyLFxuICB1c2VyLFxuICB2b3RlLFxufSBmcm9tIFwiLi9zY2hlbWFcIjtcbmltcG9ydCB7IGdlbmVyYXRlSGFzaGVkUGFzc3dvcmQgfSBmcm9tIFwiLi91dGlsc1wiO1xuXG4vLyBPcHRpb25hbGx5LCBpZiBub3QgdXNpbmcgZW1haWwvcGFzcyBsb2dpbiwgeW91IGNhblxuLy8gdXNlIHRoZSBEcml6emxlIGFkYXB0ZXIgZm9yIEF1dGguanMgLyBOZXh0QXV0aFxuLy8gaHR0cHM6Ly9hdXRoanMuZGV2L3JlZmVyZW5jZS9hZGFwdGVyL2RyaXp6bGVcblxuLy8gYmlvbWUtaWdub3JlIGxpbnQ6IEZvcmJpZGRlbiBub24tbnVsbCBhc3NlcnRpb24uXG5jb25zdCBjbGllbnQgPSBwb3N0Z3Jlcyhwcm9jZXNzLmVudi5QT1NUR1JFU19VUkwhKTtcbmNvbnN0IGRiID0gZHJpenpsZShjbGllbnQpO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0VXNlcihlbWFpbDogc3RyaW5nKTogUHJvbWlzZTxVc2VyW10+IHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gYXdhaXQgZGIuc2VsZWN0KCkuZnJvbSh1c2VyKS53aGVyZShlcSh1c2VyLmVtYWlsLCBlbWFpbCkpO1xuICB9IGNhdGNoIChfZXJyb3IpIHtcbiAgICB0aHJvdyBuZXcgQ2hhdFNES0Vycm9yKFxuICAgICAgXCJiYWRfcmVxdWVzdDpkYXRhYmFzZVwiLFxuICAgICAgXCJGYWlsZWQgdG8gZ2V0IHVzZXIgYnkgZW1haWxcIlxuICAgICk7XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVVzZXIoZW1haWw6IHN0cmluZywgcGFzc3dvcmQ6IHN0cmluZykge1xuICBjb25zdCBoYXNoZWRQYXNzd29yZCA9IGdlbmVyYXRlSGFzaGVkUGFzc3dvcmQocGFzc3dvcmQpO1xuXG4gIHRyeSB7XG4gICAgcmV0dXJuIGF3YWl0IGRiLmluc2VydCh1c2VyKS52YWx1ZXMoeyBlbWFpbCwgcGFzc3dvcmQ6IGhhc2hlZFBhc3N3b3JkIH0pO1xuICB9IGNhdGNoIChfZXJyb3IpIHtcbiAgICB0aHJvdyBuZXcgQ2hhdFNES0Vycm9yKFwiYmFkX3JlcXVlc3Q6ZGF0YWJhc2VcIiwgXCJGYWlsZWQgdG8gY3JlYXRlIHVzZXJcIik7XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUd1ZXN0VXNlcigpIHtcbiAgY29uc3QgZW1haWwgPSBgZ3Vlc3QtJHtEYXRlLm5vdygpfWA7XG4gIGNvbnN0IHBhc3N3b3JkID0gZ2VuZXJhdGVIYXNoZWRQYXNzd29yZChnZW5lcmF0ZVVVSUQoKSk7XG5cbiAgdHJ5IHtcbiAgICByZXR1cm4gYXdhaXQgZGIuaW5zZXJ0KHVzZXIpLnZhbHVlcyh7IGVtYWlsLCBwYXNzd29yZCB9KS5yZXR1cm5pbmcoe1xuICAgICAgaWQ6IHVzZXIuaWQsXG4gICAgICBlbWFpbDogdXNlci5lbWFpbCxcbiAgICB9KTtcbiAgfSBjYXRjaCAoX2Vycm9yKSB7XG4gICAgdGhyb3cgbmV3IENoYXRTREtFcnJvcihcbiAgICAgIFwiYmFkX3JlcXVlc3Q6ZGF0YWJhc2VcIixcbiAgICAgIFwiRmFpbGVkIHRvIGNyZWF0ZSBndWVzdCB1c2VyXCJcbiAgICApO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzYXZlQ2hhdCh7XG4gIGlkLFxuICB1c2VySWQsXG4gIHRpdGxlLFxuICB2aXNpYmlsaXR5LFxufToge1xuICBpZDogc3RyaW5nO1xuICB1c2VySWQ6IHN0cmluZztcbiAgdGl0bGU6IHN0cmluZztcbiAgdmlzaWJpbGl0eTogVmlzaWJpbGl0eVR5cGU7XG59KSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIGF3YWl0IGRiLmluc2VydChjaGF0KS52YWx1ZXMoe1xuICAgICAgaWQsXG4gICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICB1c2VySWQsXG4gICAgICB0aXRsZSxcbiAgICAgIHZpc2liaWxpdHksXG4gICAgfSk7XG4gIH0gY2F0Y2ggKF9lcnJvcikge1xuICAgIHRocm93IG5ldyBDaGF0U0RLRXJyb3IoXCJiYWRfcmVxdWVzdDpkYXRhYmFzZVwiLCBcIkZhaWxlZCB0byBzYXZlIGNoYXRcIik7XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUNoYXRCeUlkKHsgaWQgfTogeyBpZDogc3RyaW5nIH0pIHtcbiAgdHJ5IHtcbiAgICBhd2FpdCBkYi5kZWxldGUodm90ZSkud2hlcmUoZXEodm90ZS5jaGF0SWQsIGlkKSk7XG4gICAgYXdhaXQgZGIuZGVsZXRlKG1lc3NhZ2UpLndoZXJlKGVxKG1lc3NhZ2UuY2hhdElkLCBpZCkpO1xuICAgIGF3YWl0IGRiLmRlbGV0ZShzdHJlYW0pLndoZXJlKGVxKHN0cmVhbS5jaGF0SWQsIGlkKSk7XG5cbiAgICBjb25zdCBbY2hhdHNEZWxldGVkXSA9IGF3YWl0IGRiXG4gICAgICAuZGVsZXRlKGNoYXQpXG4gICAgICAud2hlcmUoZXEoY2hhdC5pZCwgaWQpKVxuICAgICAgLnJldHVybmluZygpO1xuICAgIHJldHVybiBjaGF0c0RlbGV0ZWQ7XG4gIH0gY2F0Y2ggKF9lcnJvcikge1xuICAgIHRocm93IG5ldyBDaGF0U0RLRXJyb3IoXG4gICAgICBcImJhZF9yZXF1ZXN0OmRhdGFiYXNlXCIsXG4gICAgICBcIkZhaWxlZCB0byBkZWxldGUgY2hhdCBieSBpZFwiXG4gICAgKTtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlQWxsQ2hhdHNCeVVzZXJJZCh7IHVzZXJJZCB9OiB7IHVzZXJJZDogc3RyaW5nIH0pIHtcbiAgdHJ5IHtcbiAgICBjb25zdCB1c2VyQ2hhdHMgPSBhd2FpdCBkYlxuICAgICAgLnNlbGVjdCh7IGlkOiBjaGF0LmlkIH0pXG4gICAgICAuZnJvbShjaGF0KVxuICAgICAgLndoZXJlKGVxKGNoYXQudXNlcklkLCB1c2VySWQpKTtcblxuICAgIGlmICh1c2VyQ2hhdHMubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4geyBkZWxldGVkQ291bnQ6IDAgfTtcbiAgICB9XG5cbiAgICBjb25zdCBjaGF0SWRzID0gdXNlckNoYXRzLm1hcCgoYykgPT4gYy5pZCk7XG5cbiAgICBhd2FpdCBkYi5kZWxldGUodm90ZSkud2hlcmUoaW5BcnJheSh2b3RlLmNoYXRJZCwgY2hhdElkcykpO1xuICAgIGF3YWl0IGRiLmRlbGV0ZShtZXNzYWdlKS53aGVyZShpbkFycmF5KG1lc3NhZ2UuY2hhdElkLCBjaGF0SWRzKSk7XG4gICAgYXdhaXQgZGIuZGVsZXRlKHN0cmVhbSkud2hlcmUoaW5BcnJheShzdHJlYW0uY2hhdElkLCBjaGF0SWRzKSk7XG5cbiAgICBjb25zdCBkZWxldGVkQ2hhdHMgPSBhd2FpdCBkYlxuICAgICAgLmRlbGV0ZShjaGF0KVxuICAgICAgLndoZXJlKGVxKGNoYXQudXNlcklkLCB1c2VySWQpKVxuICAgICAgLnJldHVybmluZygpO1xuXG4gICAgcmV0dXJuIHsgZGVsZXRlZENvdW50OiBkZWxldGVkQ2hhdHMubGVuZ3RoIH07XG4gIH0gY2F0Y2ggKF9lcnJvcikge1xuICAgIHRocm93IG5ldyBDaGF0U0RLRXJyb3IoXG4gICAgICBcImJhZF9yZXF1ZXN0OmRhdGFiYXNlXCIsXG4gICAgICBcIkZhaWxlZCB0byBkZWxldGUgYWxsIGNoYXRzIGJ5IHVzZXIgaWRcIlxuICAgICk7XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENoYXRzQnlVc2VySWQoe1xuICBpZCxcbiAgbGltaXQsXG4gIHN0YXJ0aW5nQWZ0ZXIsXG4gIGVuZGluZ0JlZm9yZSxcbn06IHtcbiAgaWQ6IHN0cmluZztcbiAgbGltaXQ6IG51bWJlcjtcbiAgc3RhcnRpbmdBZnRlcjogc3RyaW5nIHwgbnVsbDtcbiAgZW5kaW5nQmVmb3JlOiBzdHJpbmcgfCBudWxsO1xufSkge1xuICB0cnkge1xuICAgIGNvbnN0IGV4dGVuZGVkTGltaXQgPSBsaW1pdCArIDE7XG5cbiAgICBjb25zdCBxdWVyeSA9ICh3aGVyZUNvbmRpdGlvbj86IFNRTDxhbnk+KSA9PlxuICAgICAgZGJcbiAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgIC5mcm9tKGNoYXQpXG4gICAgICAgIC53aGVyZShcbiAgICAgICAgICB3aGVyZUNvbmRpdGlvblxuICAgICAgICAgICAgPyBhbmQod2hlcmVDb25kaXRpb24sIGVxKGNoYXQudXNlcklkLCBpZCkpXG4gICAgICAgICAgICA6IGVxKGNoYXQudXNlcklkLCBpZClcbiAgICAgICAgKVxuICAgICAgICAub3JkZXJCeShkZXNjKGNoYXQuY3JlYXRlZEF0KSlcbiAgICAgICAgLmxpbWl0KGV4dGVuZGVkTGltaXQpO1xuXG4gICAgbGV0IGZpbHRlcmVkQ2hhdHM6IENoYXRbXSA9IFtdO1xuXG4gICAgaWYgKHN0YXJ0aW5nQWZ0ZXIpIHtcbiAgICAgIGNvbnN0IFtzZWxlY3RlZENoYXRdID0gYXdhaXQgZGJcbiAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgIC5mcm9tKGNoYXQpXG4gICAgICAgIC53aGVyZShlcShjaGF0LmlkLCBzdGFydGluZ0FmdGVyKSlcbiAgICAgICAgLmxpbWl0KDEpO1xuXG4gICAgICBpZiAoIXNlbGVjdGVkQ2hhdCkge1xuICAgICAgICB0aHJvdyBuZXcgQ2hhdFNES0Vycm9yKFxuICAgICAgICAgIFwibm90X2ZvdW5kOmRhdGFiYXNlXCIsXG4gICAgICAgICAgYENoYXQgd2l0aCBpZCAke3N0YXJ0aW5nQWZ0ZXJ9IG5vdCBmb3VuZGBcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgZmlsdGVyZWRDaGF0cyA9IGF3YWl0IHF1ZXJ5KGd0KGNoYXQuY3JlYXRlZEF0LCBzZWxlY3RlZENoYXQuY3JlYXRlZEF0KSk7XG4gICAgfSBlbHNlIGlmIChlbmRpbmdCZWZvcmUpIHtcbiAgICAgIGNvbnN0IFtzZWxlY3RlZENoYXRdID0gYXdhaXQgZGJcbiAgICAgICAgLnNlbGVjdCgpXG4gICAgICAgIC5mcm9tKGNoYXQpXG4gICAgICAgIC53aGVyZShlcShjaGF0LmlkLCBlbmRpbmdCZWZvcmUpKVxuICAgICAgICAubGltaXQoMSk7XG5cbiAgICAgIGlmICghc2VsZWN0ZWRDaGF0KSB7XG4gICAgICAgIHRocm93IG5ldyBDaGF0U0RLRXJyb3IoXG4gICAgICAgICAgXCJub3RfZm91bmQ6ZGF0YWJhc2VcIixcbiAgICAgICAgICBgQ2hhdCB3aXRoIGlkICR7ZW5kaW5nQmVmb3JlfSBub3QgZm91bmRgXG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIGZpbHRlcmVkQ2hhdHMgPSBhd2FpdCBxdWVyeShsdChjaGF0LmNyZWF0ZWRBdCwgc2VsZWN0ZWRDaGF0LmNyZWF0ZWRBdCkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBmaWx0ZXJlZENoYXRzID0gYXdhaXQgcXVlcnkoKTtcbiAgICB9XG5cbiAgICBjb25zdCBoYXNNb3JlID0gZmlsdGVyZWRDaGF0cy5sZW5ndGggPiBsaW1pdDtcblxuICAgIHJldHVybiB7XG4gICAgICBjaGF0czogaGFzTW9yZSA/IGZpbHRlcmVkQ2hhdHMuc2xpY2UoMCwgbGltaXQpIDogZmlsdGVyZWRDaGF0cyxcbiAgICAgIGhhc01vcmUsXG4gICAgfTtcbiAgfSBjYXRjaCAoX2Vycm9yKSB7XG4gICAgdGhyb3cgbmV3IENoYXRTREtFcnJvcihcbiAgICAgIFwiYmFkX3JlcXVlc3Q6ZGF0YWJhc2VcIixcbiAgICAgIFwiRmFpbGVkIHRvIGdldCBjaGF0cyBieSB1c2VyIGlkXCJcbiAgICApO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRDaGF0QnlJZCh7IGlkIH06IHsgaWQ6IHN0cmluZyB9KSB7XG4gIHRyeSB7XG4gICAgY29uc3QgW3NlbGVjdGVkQ2hhdF0gPSBhd2FpdCBkYi5zZWxlY3QoKS5mcm9tKGNoYXQpLndoZXJlKGVxKGNoYXQuaWQsIGlkKSk7XG4gICAgaWYgKCFzZWxlY3RlZENoYXQpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHJldHVybiBzZWxlY3RlZENoYXQ7XG4gIH0gY2F0Y2ggKF9lcnJvcikge1xuICAgIHRocm93IG5ldyBDaGF0U0RLRXJyb3IoXCJiYWRfcmVxdWVzdDpkYXRhYmFzZVwiLCBcIkZhaWxlZCB0byBnZXQgY2hhdCBieSBpZFwiKTtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2F2ZU1lc3NhZ2VzKHsgbWVzc2FnZXMgfTogeyBtZXNzYWdlczogREJNZXNzYWdlW10gfSkge1xuICB0cnkge1xuICAgIHJldHVybiBhd2FpdCBkYi5pbnNlcnQobWVzc2FnZSkudmFsdWVzKG1lc3NhZ2VzKTtcbiAgfSBjYXRjaCAoX2Vycm9yKSB7XG4gICAgdGhyb3cgbmV3IENoYXRTREtFcnJvcihcImJhZF9yZXF1ZXN0OmRhdGFiYXNlXCIsIFwiRmFpbGVkIHRvIHNhdmUgbWVzc2FnZXNcIik7XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZU1lc3NhZ2Uoe1xuICBpZCxcbiAgcGFydHMsXG59OiB7XG4gIGlkOiBzdHJpbmc7XG4gIHBhcnRzOiBEQk1lc3NhZ2VbXCJwYXJ0c1wiXTtcbn0pIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gYXdhaXQgZGIudXBkYXRlKG1lc3NhZ2UpLnNldCh7IHBhcnRzIH0pLndoZXJlKGVxKG1lc3NhZ2UuaWQsIGlkKSk7XG4gIH0gY2F0Y2ggKF9lcnJvcikge1xuICAgIHRocm93IG5ldyBDaGF0U0RLRXJyb3IoXCJiYWRfcmVxdWVzdDpkYXRhYmFzZVwiLCBcIkZhaWxlZCB0byB1cGRhdGUgbWVzc2FnZVwiKTtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0TWVzc2FnZXNCeUNoYXRJZCh7IGlkIH06IHsgaWQ6IHN0cmluZyB9KSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIGF3YWl0IGRiXG4gICAgICAuc2VsZWN0KClcbiAgICAgIC5mcm9tKG1lc3NhZ2UpXG4gICAgICAud2hlcmUoZXEobWVzc2FnZS5jaGF0SWQsIGlkKSlcbiAgICAgIC5vcmRlckJ5KGFzYyhtZXNzYWdlLmNyZWF0ZWRBdCkpO1xuICB9IGNhdGNoIChfZXJyb3IpIHtcbiAgICB0aHJvdyBuZXcgQ2hhdFNES0Vycm9yKFxuICAgICAgXCJiYWRfcmVxdWVzdDpkYXRhYmFzZVwiLFxuICAgICAgXCJGYWlsZWQgdG8gZ2V0IG1lc3NhZ2VzIGJ5IGNoYXQgaWRcIlxuICAgICk7XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHZvdGVNZXNzYWdlKHtcbiAgY2hhdElkLFxuICBtZXNzYWdlSWQsXG4gIHR5cGUsXG59OiB7XG4gIGNoYXRJZDogc3RyaW5nO1xuICBtZXNzYWdlSWQ6IHN0cmluZztcbiAgdHlwZTogXCJ1cFwiIHwgXCJkb3duXCI7XG59KSB7XG4gIHRyeSB7XG4gICAgY29uc3QgW2V4aXN0aW5nVm90ZV0gPSBhd2FpdCBkYlxuICAgICAgLnNlbGVjdCgpXG4gICAgICAuZnJvbSh2b3RlKVxuICAgICAgLndoZXJlKGFuZChlcSh2b3RlLm1lc3NhZ2VJZCwgbWVzc2FnZUlkKSkpO1xuXG4gICAgaWYgKGV4aXN0aW5nVm90ZSkge1xuICAgICAgcmV0dXJuIGF3YWl0IGRiXG4gICAgICAgIC51cGRhdGUodm90ZSlcbiAgICAgICAgLnNldCh7IGlzVXB2b3RlZDogdHlwZSA9PT0gXCJ1cFwiIH0pXG4gICAgICAgIC53aGVyZShhbmQoZXEodm90ZS5tZXNzYWdlSWQsIG1lc3NhZ2VJZCksIGVxKHZvdGUuY2hhdElkLCBjaGF0SWQpKSk7XG4gICAgfVxuICAgIHJldHVybiBhd2FpdCBkYi5pbnNlcnQodm90ZSkudmFsdWVzKHtcbiAgICAgIGNoYXRJZCxcbiAgICAgIG1lc3NhZ2VJZCxcbiAgICAgIGlzVXB2b3RlZDogdHlwZSA9PT0gXCJ1cFwiLFxuICAgIH0pO1xuICB9IGNhdGNoIChfZXJyb3IpIHtcbiAgICB0aHJvdyBuZXcgQ2hhdFNES0Vycm9yKFwiYmFkX3JlcXVlc3Q6ZGF0YWJhc2VcIiwgXCJGYWlsZWQgdG8gdm90ZSBtZXNzYWdlXCIpO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRWb3Rlc0J5Q2hhdElkKHsgaWQgfTogeyBpZDogc3RyaW5nIH0pIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gYXdhaXQgZGIuc2VsZWN0KCkuZnJvbSh2b3RlKS53aGVyZShlcSh2b3RlLmNoYXRJZCwgaWQpKTtcbiAgfSBjYXRjaCAoX2Vycm9yKSB7XG4gICAgdGhyb3cgbmV3IENoYXRTREtFcnJvcihcbiAgICAgIFwiYmFkX3JlcXVlc3Q6ZGF0YWJhc2VcIixcbiAgICAgIFwiRmFpbGVkIHRvIGdldCB2b3RlcyBieSBjaGF0IGlkXCJcbiAgICApO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzYXZlRG9jdW1lbnQoe1xuICBpZCxcbiAgdGl0bGUsXG4gIGtpbmQsXG4gIGNvbnRlbnQsXG4gIHVzZXJJZCxcbn06IHtcbiAgaWQ6IHN0cmluZztcbiAgdGl0bGU6IHN0cmluZztcbiAga2luZDogQXJ0aWZhY3RLaW5kO1xuICBjb250ZW50OiBzdHJpbmc7XG4gIHVzZXJJZDogc3RyaW5nO1xufSkge1xuICB0cnkge1xuICAgIHJldHVybiBhd2FpdCBkYlxuICAgICAgLmluc2VydChkb2N1bWVudClcbiAgICAgIC52YWx1ZXMoe1xuICAgICAgICBpZCxcbiAgICAgICAgdGl0bGUsXG4gICAgICAgIGtpbmQsXG4gICAgICAgIGNvbnRlbnQsXG4gICAgICAgIHVzZXJJZCxcbiAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgICAgfSlcbiAgICAgIC5yZXR1cm5pbmcoKTtcbiAgfSBjYXRjaCAoX2Vycm9yKSB7XG4gICAgdGhyb3cgbmV3IENoYXRTREtFcnJvcihcImJhZF9yZXF1ZXN0OmRhdGFiYXNlXCIsIFwiRmFpbGVkIHRvIHNhdmUgZG9jdW1lbnRcIik7XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldERvY3VtZW50c0J5SWQoeyBpZCB9OiB7IGlkOiBzdHJpbmcgfSkge1xuICB0cnkge1xuICAgIGNvbnN0IGRvY3VtZW50cyA9IGF3YWl0IGRiXG4gICAgICAuc2VsZWN0KClcbiAgICAgIC5mcm9tKGRvY3VtZW50KVxuICAgICAgLndoZXJlKGVxKGRvY3VtZW50LmlkLCBpZCkpXG4gICAgICAub3JkZXJCeShhc2MoZG9jdW1lbnQuY3JlYXRlZEF0KSk7XG5cbiAgICByZXR1cm4gZG9jdW1lbnRzO1xuICB9IGNhdGNoIChfZXJyb3IpIHtcbiAgICB0aHJvdyBuZXcgQ2hhdFNES0Vycm9yKFxuICAgICAgXCJiYWRfcmVxdWVzdDpkYXRhYmFzZVwiLFxuICAgICAgXCJGYWlsZWQgdG8gZ2V0IGRvY3VtZW50cyBieSBpZFwiXG4gICAgKTtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RG9jdW1lbnRCeUlkKHsgaWQgfTogeyBpZDogc3RyaW5nIH0pIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBbc2VsZWN0ZWREb2N1bWVudF0gPSBhd2FpdCBkYlxuICAgICAgLnNlbGVjdCgpXG4gICAgICAuZnJvbShkb2N1bWVudClcbiAgICAgIC53aGVyZShlcShkb2N1bWVudC5pZCwgaWQpKVxuICAgICAgLm9yZGVyQnkoZGVzYyhkb2N1bWVudC5jcmVhdGVkQXQpKTtcblxuICAgIHJldHVybiBzZWxlY3RlZERvY3VtZW50O1xuICB9IGNhdGNoIChfZXJyb3IpIHtcbiAgICB0aHJvdyBuZXcgQ2hhdFNES0Vycm9yKFxuICAgICAgXCJiYWRfcmVxdWVzdDpkYXRhYmFzZVwiLFxuICAgICAgXCJGYWlsZWQgdG8gZ2V0IGRvY3VtZW50IGJ5IGlkXCJcbiAgICApO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVEb2N1bWVudHNCeUlkQWZ0ZXJUaW1lc3RhbXAoe1xuICBpZCxcbiAgdGltZXN0YW1wLFxufToge1xuICBpZDogc3RyaW5nO1xuICB0aW1lc3RhbXA6IERhdGU7XG59KSB7XG4gIHRyeSB7XG4gICAgYXdhaXQgZGJcbiAgICAgIC5kZWxldGUoc3VnZ2VzdGlvbilcbiAgICAgIC53aGVyZShcbiAgICAgICAgYW5kKFxuICAgICAgICAgIGVxKHN1Z2dlc3Rpb24uZG9jdW1lbnRJZCwgaWQpLFxuICAgICAgICAgIGd0KHN1Z2dlc3Rpb24uZG9jdW1lbnRDcmVhdGVkQXQsIHRpbWVzdGFtcClcbiAgICAgICAgKVxuICAgICAgKTtcblxuICAgIHJldHVybiBhd2FpdCBkYlxuICAgICAgLmRlbGV0ZShkb2N1bWVudClcbiAgICAgIC53aGVyZShhbmQoZXEoZG9jdW1lbnQuaWQsIGlkKSwgZ3QoZG9jdW1lbnQuY3JlYXRlZEF0LCB0aW1lc3RhbXApKSlcbiAgICAgIC5yZXR1cm5pbmcoKTtcbiAgfSBjYXRjaCAoX2Vycm9yKSB7XG4gICAgdGhyb3cgbmV3IENoYXRTREtFcnJvcihcbiAgICAgIFwiYmFkX3JlcXVlc3Q6ZGF0YWJhc2VcIixcbiAgICAgIFwiRmFpbGVkIHRvIGRlbGV0ZSBkb2N1bWVudHMgYnkgaWQgYWZ0ZXIgdGltZXN0YW1wXCJcbiAgICApO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzYXZlU3VnZ2VzdGlvbnMoe1xuICBzdWdnZXN0aW9ucyxcbn06IHtcbiAgc3VnZ2VzdGlvbnM6IFN1Z2dlc3Rpb25bXTtcbn0pIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gYXdhaXQgZGIuaW5zZXJ0KHN1Z2dlc3Rpb24pLnZhbHVlcyhzdWdnZXN0aW9ucyk7XG4gIH0gY2F0Y2ggKF9lcnJvcikge1xuICAgIHRocm93IG5ldyBDaGF0U0RLRXJyb3IoXG4gICAgICBcImJhZF9yZXF1ZXN0OmRhdGFiYXNlXCIsXG4gICAgICBcIkZhaWxlZCB0byBzYXZlIHN1Z2dlc3Rpb25zXCJcbiAgICApO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRTdWdnZXN0aW9uc0J5RG9jdW1lbnRJZCh7XG4gIGRvY3VtZW50SWQsXG59OiB7XG4gIGRvY3VtZW50SWQ6IHN0cmluZztcbn0pIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gYXdhaXQgZGJcbiAgICAgIC5zZWxlY3QoKVxuICAgICAgLmZyb20oc3VnZ2VzdGlvbilcbiAgICAgIC53aGVyZShlcShzdWdnZXN0aW9uLmRvY3VtZW50SWQsIGRvY3VtZW50SWQpKTtcbiAgfSBjYXRjaCAoX2Vycm9yKSB7XG4gICAgdGhyb3cgbmV3IENoYXRTREtFcnJvcihcbiAgICAgIFwiYmFkX3JlcXVlc3Q6ZGF0YWJhc2VcIixcbiAgICAgIFwiRmFpbGVkIHRvIGdldCBzdWdnZXN0aW9ucyBieSBkb2N1bWVudCBpZFwiXG4gICAgKTtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0TWVzc2FnZUJ5SWQoeyBpZCB9OiB7IGlkOiBzdHJpbmcgfSkge1xuICB0cnkge1xuICAgIHJldHVybiBhd2FpdCBkYi5zZWxlY3QoKS5mcm9tKG1lc3NhZ2UpLndoZXJlKGVxKG1lc3NhZ2UuaWQsIGlkKSk7XG4gIH0gY2F0Y2ggKF9lcnJvcikge1xuICAgIHRocm93IG5ldyBDaGF0U0RLRXJyb3IoXG4gICAgICBcImJhZF9yZXF1ZXN0OmRhdGFiYXNlXCIsXG4gICAgICBcIkZhaWxlZCB0byBnZXQgbWVzc2FnZSBieSBpZFwiXG4gICAgKTtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlTWVzc2FnZXNCeUNoYXRJZEFmdGVyVGltZXN0YW1wKHtcbiAgY2hhdElkLFxuICB0aW1lc3RhbXAsXG59OiB7XG4gIGNoYXRJZDogc3RyaW5nO1xuICB0aW1lc3RhbXA6IERhdGU7XG59KSB7XG4gIHRyeSB7XG4gICAgY29uc3QgbWVzc2FnZXNUb0RlbGV0ZSA9IGF3YWl0IGRiXG4gICAgICAuc2VsZWN0KHsgaWQ6IG1lc3NhZ2UuaWQgfSlcbiAgICAgIC5mcm9tKG1lc3NhZ2UpXG4gICAgICAud2hlcmUoXG4gICAgICAgIGFuZChlcShtZXNzYWdlLmNoYXRJZCwgY2hhdElkKSwgZ3RlKG1lc3NhZ2UuY3JlYXRlZEF0LCB0aW1lc3RhbXApKVxuICAgICAgKTtcblxuICAgIGNvbnN0IG1lc3NhZ2VJZHMgPSBtZXNzYWdlc1RvRGVsZXRlLm1hcChcbiAgICAgIChjdXJyZW50TWVzc2FnZSkgPT4gY3VycmVudE1lc3NhZ2UuaWRcbiAgICApO1xuXG4gICAgaWYgKG1lc3NhZ2VJZHMubGVuZ3RoID4gMCkge1xuICAgICAgYXdhaXQgZGJcbiAgICAgICAgLmRlbGV0ZSh2b3RlKVxuICAgICAgICAud2hlcmUoXG4gICAgICAgICAgYW5kKGVxKHZvdGUuY2hhdElkLCBjaGF0SWQpLCBpbkFycmF5KHZvdGUubWVzc2FnZUlkLCBtZXNzYWdlSWRzKSlcbiAgICAgICAgKTtcblxuICAgICAgcmV0dXJuIGF3YWl0IGRiXG4gICAgICAgIC5kZWxldGUobWVzc2FnZSlcbiAgICAgICAgLndoZXJlKFxuICAgICAgICAgIGFuZChlcShtZXNzYWdlLmNoYXRJZCwgY2hhdElkKSwgaW5BcnJheShtZXNzYWdlLmlkLCBtZXNzYWdlSWRzKSlcbiAgICAgICAgKTtcbiAgICB9XG4gIH0gY2F0Y2ggKF9lcnJvcikge1xuICAgIHRocm93IG5ldyBDaGF0U0RLRXJyb3IoXG4gICAgICBcImJhZF9yZXF1ZXN0OmRhdGFiYXNlXCIsXG4gICAgICBcIkZhaWxlZCB0byBkZWxldGUgbWVzc2FnZXMgYnkgY2hhdCBpZCBhZnRlciB0aW1lc3RhbXBcIlxuICAgICk7XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZUNoYXRWaXNpYmlsaXR5QnlJZCh7XG4gIGNoYXRJZCxcbiAgdmlzaWJpbGl0eSxcbn06IHtcbiAgY2hhdElkOiBzdHJpbmc7XG4gIHZpc2liaWxpdHk6IFwicHJpdmF0ZVwiIHwgXCJwdWJsaWNcIjtcbn0pIHtcbiAgdHJ5IHtcbiAgICByZXR1cm4gYXdhaXQgZGIudXBkYXRlKGNoYXQpLnNldCh7IHZpc2liaWxpdHkgfSkud2hlcmUoZXEoY2hhdC5pZCwgY2hhdElkKSk7XG4gIH0gY2F0Y2ggKF9lcnJvcikge1xuICAgIHRocm93IG5ldyBDaGF0U0RLRXJyb3IoXG4gICAgICBcImJhZF9yZXF1ZXN0OmRhdGFiYXNlXCIsXG4gICAgICBcIkZhaWxlZCB0byB1cGRhdGUgY2hhdCB2aXNpYmlsaXR5IGJ5IGlkXCJcbiAgICApO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVDaGF0VGl0bGVCeUlkKHtcbiAgY2hhdElkLFxuICB0aXRsZSxcbn06IHtcbiAgY2hhdElkOiBzdHJpbmc7XG4gIHRpdGxlOiBzdHJpbmc7XG59KSB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIGF3YWl0IGRiLnVwZGF0ZShjaGF0KS5zZXQoeyB0aXRsZSB9KS53aGVyZShlcShjaGF0LmlkLCBjaGF0SWQpKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLndhcm4oXCJGYWlsZWQgdG8gdXBkYXRlIHRpdGxlIGZvciBjaGF0XCIsIGNoYXRJZCwgZXJyb3IpO1xuICAgIHJldHVybjtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0TWVzc2FnZUNvdW50QnlVc2VySWQoe1xuICBpZCxcbiAgZGlmZmVyZW5jZUluSG91cnMsXG59OiB7XG4gIGlkOiBzdHJpbmc7XG4gIGRpZmZlcmVuY2VJbkhvdXJzOiBudW1iZXI7XG59KSB7XG4gIHRyeSB7XG4gICAgY29uc3QgdHdlbnR5Rm91ckhvdXJzQWdvID0gbmV3IERhdGUoXG4gICAgICBEYXRlLm5vdygpIC0gZGlmZmVyZW5jZUluSG91cnMgKiA2MCAqIDYwICogMTAwMFxuICAgICk7XG5cbiAgICBjb25zdCBbc3RhdHNdID0gYXdhaXQgZGJcbiAgICAgIC5zZWxlY3QoeyBjb3VudDogY291bnQobWVzc2FnZS5pZCkgfSlcbiAgICAgIC5mcm9tKG1lc3NhZ2UpXG4gICAgICAuaW5uZXJKb2luKGNoYXQsIGVxKG1lc3NhZ2UuY2hhdElkLCBjaGF0LmlkKSlcbiAgICAgIC53aGVyZShcbiAgICAgICAgYW5kKFxuICAgICAgICAgIGVxKGNoYXQudXNlcklkLCBpZCksXG4gICAgICAgICAgZ3RlKG1lc3NhZ2UuY3JlYXRlZEF0LCB0d2VudHlGb3VySG91cnNBZ28pLFxuICAgICAgICAgIGVxKG1lc3NhZ2Uucm9sZSwgXCJ1c2VyXCIpXG4gICAgICAgIClcbiAgICAgIClcbiAgICAgIC5leGVjdXRlKCk7XG5cbiAgICByZXR1cm4gc3RhdHM/LmNvdW50ID8/IDA7XG4gIH0gY2F0Y2ggKF9lcnJvcikge1xuICAgIHRocm93IG5ldyBDaGF0U0RLRXJyb3IoXG4gICAgICBcImJhZF9yZXF1ZXN0OmRhdGFiYXNlXCIsXG4gICAgICBcIkZhaWxlZCB0byBnZXQgbWVzc2FnZSBjb3VudCBieSB1c2VyIGlkXCJcbiAgICApO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVTdHJlYW1JZCh7XG4gIHN0cmVhbUlkLFxuICBjaGF0SWQsXG59OiB7XG4gIHN0cmVhbUlkOiBzdHJpbmc7XG4gIGNoYXRJZDogc3RyaW5nO1xufSkge1xuICB0cnkge1xuICAgIGF3YWl0IGRiXG4gICAgICAuaW5zZXJ0KHN0cmVhbSlcbiAgICAgIC52YWx1ZXMoeyBpZDogc3RyZWFtSWQsIGNoYXRJZCwgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpIH0pO1xuICB9IGNhdGNoIChfZXJyb3IpIHtcbiAgICB0aHJvdyBuZXcgQ2hhdFNES0Vycm9yKFxuICAgICAgXCJiYWRfcmVxdWVzdDpkYXRhYmFzZVwiLFxuICAgICAgXCJGYWlsZWQgdG8gY3JlYXRlIHN0cmVhbSBpZFwiXG4gICAgKTtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0U3RyZWFtSWRzQnlDaGF0SWQoeyBjaGF0SWQgfTogeyBjaGF0SWQ6IHN0cmluZyB9KSB7XG4gIHRyeSB7XG4gICAgY29uc3Qgc3RyZWFtSWRzID0gYXdhaXQgZGJcbiAgICAgIC5zZWxlY3QoeyBpZDogc3RyZWFtLmlkIH0pXG4gICAgICAuZnJvbShzdHJlYW0pXG4gICAgICAud2hlcmUoZXEoc3RyZWFtLmNoYXRJZCwgY2hhdElkKSlcbiAgICAgIC5vcmRlckJ5KGFzYyhzdHJlYW0uY3JlYXRlZEF0KSlcbiAgICAgIC5leGVjdXRlKCk7XG5cbiAgICByZXR1cm4gc3RyZWFtSWRzLm1hcCgoeyBpZCB9KSA9PiBpZCk7XG4gIH0gY2F0Y2ggKF9lcnJvcikge1xuICAgIHRocm93IG5ldyBDaGF0U0RLRXJyb3IoXG4gICAgICBcImJhZF9yZXF1ZXN0OmRhdGFiYXNlXCIsXG4gICAgICBcIkZhaWxlZCB0byBnZXQgc3RyZWFtIGlkcyBieSBjaGF0IGlkXCJcbiAgICApO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBlbnN1cmVHdWVzdFVzZXJFeGlzdHMoaWQ6IHN0cmluZykge1xuICB0cnkge1xuICAgIGNvbnN0IFtleGlzdGluZ1VzZXJdID0gYXdhaXQgZGIuc2VsZWN0KCkuZnJvbSh1c2VyKS53aGVyZShlcSh1c2VyLmlkLCBpZCkpO1xuICAgIGlmICghZXhpc3RpbmdVc2VyKSB7XG4gICAgICBjb25zb2xlLmxvZyhcIkNyZWF0aW5nIGd1ZXN0IHVzZXI6XCIsIGlkKTtcbiAgICAgIGF3YWl0IGRiLmluc2VydCh1c2VyKS52YWx1ZXMoe1xuICAgICAgICBpZCxcbiAgICAgICAgZW1haWw6IFwiZ3Vlc3RAc2VudGluZWwubG9jYWxcIixcbiAgICAgIH0pO1xuICAgIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZW5zdXJpbmcgZ3Vlc3QgdXNlciBleGlzdHM6XCIsIGVycm9yKTtcbiAgfVxufVxuXG4iXSwibmFtZXMiOlsiYW5kIiwiYXNjIiwiY291bnQiLCJkZXNjIiwiZXEiLCJndCIsImd0ZSIsImluQXJyYXkiLCJsdCIsImRyaXp6bGUiLCJwb3N0Z3JlcyIsIkNoYXRTREtFcnJvciIsImdlbmVyYXRlVVVJRCIsImNoYXQiLCJkb2N1bWVudCIsIm1lc3NhZ2UiLCJzdHJlYW0iLCJzdWdnZXN0aW9uIiwidXNlciIsInZvdGUiLCJnZW5lcmF0ZUhhc2hlZFBhc3N3b3JkIiwiY2xpZW50IiwicHJvY2VzcyIsImVudiIsIlBPU1RHUkVTX1VSTCIsImRiIiwiZ2V0VXNlciIsImVtYWlsIiwic2VsZWN0IiwiZnJvbSIsIndoZXJlIiwiX2Vycm9yIiwiY3JlYXRlVXNlciIsInBhc3N3b3JkIiwiaGFzaGVkUGFzc3dvcmQiLCJpbnNlcnQiLCJ2YWx1ZXMiLCJjcmVhdGVHdWVzdFVzZXIiLCJEYXRlIiwibm93IiwicmV0dXJuaW5nIiwiaWQiLCJzYXZlQ2hhdCIsInVzZXJJZCIsInRpdGxlIiwidmlzaWJpbGl0eSIsImNyZWF0ZWRBdCIsImRlbGV0ZUNoYXRCeUlkIiwiZGVsZXRlIiwiY2hhdElkIiwiY2hhdHNEZWxldGVkIiwiZGVsZXRlQWxsQ2hhdHNCeVVzZXJJZCIsInVzZXJDaGF0cyIsImxlbmd0aCIsImRlbGV0ZWRDb3VudCIsImNoYXRJZHMiLCJtYXAiLCJjIiwiZGVsZXRlZENoYXRzIiwiZ2V0Q2hhdHNCeVVzZXJJZCIsImxpbWl0Iiwic3RhcnRpbmdBZnRlciIsImVuZGluZ0JlZm9yZSIsImV4dGVuZGVkTGltaXQiLCJxdWVyeSIsIndoZXJlQ29uZGl0aW9uIiwib3JkZXJCeSIsImZpbHRlcmVkQ2hhdHMiLCJzZWxlY3RlZENoYXQiLCJoYXNNb3JlIiwiY2hhdHMiLCJzbGljZSIsImdldENoYXRCeUlkIiwic2F2ZU1lc3NhZ2VzIiwibWVzc2FnZXMiLCJ1cGRhdGVNZXNzYWdlIiwicGFydHMiLCJ1cGRhdGUiLCJzZXQiLCJnZXRNZXNzYWdlc0J5Q2hhdElkIiwidm90ZU1lc3NhZ2UiLCJtZXNzYWdlSWQiLCJ0eXBlIiwiZXhpc3RpbmdWb3RlIiwiaXNVcHZvdGVkIiwiZ2V0Vm90ZXNCeUNoYXRJZCIsInNhdmVEb2N1bWVudCIsImtpbmQiLCJjb250ZW50IiwiZ2V0RG9jdW1lbnRzQnlJZCIsImRvY3VtZW50cyIsImdldERvY3VtZW50QnlJZCIsInNlbGVjdGVkRG9jdW1lbnQiLCJkZWxldGVEb2N1bWVudHNCeUlkQWZ0ZXJUaW1lc3RhbXAiLCJ0aW1lc3RhbXAiLCJkb2N1bWVudElkIiwiZG9jdW1lbnRDcmVhdGVkQXQiLCJzYXZlU3VnZ2VzdGlvbnMiLCJzdWdnZXN0aW9ucyIsImdldFN1Z2dlc3Rpb25zQnlEb2N1bWVudElkIiwiZ2V0TWVzc2FnZUJ5SWQiLCJkZWxldGVNZXNzYWdlc0J5Q2hhdElkQWZ0ZXJUaW1lc3RhbXAiLCJtZXNzYWdlc1RvRGVsZXRlIiwibWVzc2FnZUlkcyIsImN1cnJlbnRNZXNzYWdlIiwidXBkYXRlQ2hhdFZpc2liaWxpdHlCeUlkIiwidXBkYXRlQ2hhdFRpdGxlQnlJZCIsImVycm9yIiwiY29uc29sZSIsIndhcm4iLCJnZXRNZXNzYWdlQ291bnRCeVVzZXJJZCIsImRpZmZlcmVuY2VJbkhvdXJzIiwidHdlbnR5Rm91ckhvdXJzQWdvIiwic3RhdHMiLCJpbm5lckpvaW4iLCJyb2xlIiwiZXhlY3V0ZSIsImNyZWF0ZVN0cmVhbUlkIiwic3RyZWFtSWQiLCJnZXRTdHJlYW1JZHNCeUNoYXRJZCIsInN0cmVhbUlkcyIsImVuc3VyZUd1ZXN0VXNlckV4aXN0cyIsImV4aXN0aW5nVXNlciIsImxvZyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/db/queries.ts\n");

/***/ }),

/***/ "(rsc)/./lib/db/schema.ts":
/*!**************************!*\
  !*** ./lib/db/schema.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   chat: () => (/* binding */ chat),\n/* harmony export */   document: () => (/* binding */ document),\n/* harmony export */   message: () => (/* binding */ message),\n/* harmony export */   messageDeprecated: () => (/* binding */ messageDeprecated),\n/* harmony export */   stream: () => (/* binding */ stream),\n/* harmony export */   suggestion: () => (/* binding */ suggestion),\n/* harmony export */   user: () => (/* binding */ user),\n/* harmony export */   vote: () => (/* binding */ vote),\n/* harmony export */   voteDeprecated: () => (/* binding */ voteDeprecated)\n/* harmony export */ });\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"(rsc)/./node_modules/.pnpm/drizzle-orm@0.45.1_@opentelemetry+api@1.9.0_postgres@3.4.8/node_modules/drizzle-orm/pg-core/table.js\");\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"(rsc)/./node_modules/.pnpm/drizzle-orm@0.45.1_@opentelemetry+api@1.9.0_postgres@3.4.8/node_modules/drizzle-orm/pg-core/columns/uuid.js\");\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"(rsc)/./node_modules/.pnpm/drizzle-orm@0.45.1_@opentelemetry+api@1.9.0_postgres@3.4.8/node_modules/drizzle-orm/pg-core/columns/varchar.js\");\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"(rsc)/./node_modules/.pnpm/drizzle-orm@0.45.1_@opentelemetry+api@1.9.0_postgres@3.4.8/node_modules/drizzle-orm/pg-core/columns/timestamp.js\");\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"(rsc)/./node_modules/.pnpm/drizzle-orm@0.45.1_@opentelemetry+api@1.9.0_postgres@3.4.8/node_modules/drizzle-orm/pg-core/columns/text.js\");\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"(rsc)/./node_modules/.pnpm/drizzle-orm@0.45.1_@opentelemetry+api@1.9.0_postgres@3.4.8/node_modules/drizzle-orm/pg-core/columns/json.js\");\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"(rsc)/./node_modules/.pnpm/drizzle-orm@0.45.1_@opentelemetry+api@1.9.0_postgres@3.4.8/node_modules/drizzle-orm/pg-core/columns/boolean.js\");\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"(rsc)/./node_modules/.pnpm/drizzle-orm@0.45.1_@opentelemetry+api@1.9.0_postgres@3.4.8/node_modules/drizzle-orm/pg-core/primary-keys.js\");\n/* harmony import */ var drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! drizzle-orm/pg-core */ \"(rsc)/./node_modules/.pnpm/drizzle-orm@0.45.1_@opentelemetry+api@1.9.0_postgres@3.4.8/node_modules/drizzle-orm/pg-core/foreign-keys.js\");\n\nconst user = (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.pgTable)(\"User\", {\n    id: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__.uuid)(\"id\").primaryKey().notNull().defaultRandom(),\n    email: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.varchar)(\"email\", {\n        length: 64\n    }).notNull(),\n    password: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.varchar)(\"password\", {\n        length: 64\n    })\n});\nconst chat = (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.pgTable)(\"Chat\", {\n    id: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__.uuid)(\"id\").primaryKey().notNull().defaultRandom(),\n    createdAt: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_3__.timestamp)(\"createdAt\").notNull(),\n    title: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__.text)(\"title\").notNull(),\n    userId: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__.uuid)(\"userId\").notNull().references(()=>user.id),\n    visibility: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.varchar)(\"visibility\", {\n        enum: [\n            \"public\",\n            \"private\"\n        ]\n    }).notNull().default(\"private\")\n});\n// DEPRECATED: The following schema is deprecated and will be removed in the future.\n// Read the migration guide at https://chat-sdk.dev/docs/migration-guides/message-parts\nconst messageDeprecated = (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.pgTable)(\"Message\", {\n    id: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__.uuid)(\"id\").primaryKey().notNull().defaultRandom(),\n    chatId: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__.uuid)(\"chatId\").notNull().references(()=>chat.id),\n    role: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.varchar)(\"role\").notNull(),\n    content: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_5__.json)(\"content\").notNull(),\n    createdAt: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_3__.timestamp)(\"createdAt\").notNull()\n});\nconst message = (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.pgTable)(\"Message_v2\", {\n    id: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__.uuid)(\"id\").primaryKey().notNull().defaultRandom(),\n    chatId: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__.uuid)(\"chatId\").notNull().references(()=>chat.id),\n    role: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.varchar)(\"role\").notNull(),\n    parts: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_5__.json)(\"parts\").notNull(),\n    attachments: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_5__.json)(\"attachments\").notNull(),\n    createdAt: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_3__.timestamp)(\"createdAt\").notNull()\n});\n// DEPRECATED: The following schema is deprecated and will be removed in the future.\n// Read the migration guide at https://chat-sdk.dev/docs/migration-guides/message-parts\nconst voteDeprecated = (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.pgTable)(\"Vote\", {\n    chatId: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__.uuid)(\"chatId\").notNull().references(()=>chat.id),\n    messageId: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__.uuid)(\"messageId\").notNull().references(()=>messageDeprecated.id),\n    isUpvoted: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_6__.boolean)(\"isUpvoted\").notNull()\n}, (table)=>{\n    return {\n        pk: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_7__.primaryKey)({\n            columns: [\n                table.chatId,\n                table.messageId\n            ]\n        })\n    };\n});\nconst vote = (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.pgTable)(\"Vote_v2\", {\n    chatId: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__.uuid)(\"chatId\").notNull().references(()=>chat.id),\n    messageId: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__.uuid)(\"messageId\").notNull().references(()=>message.id),\n    isUpvoted: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_6__.boolean)(\"isUpvoted\").notNull()\n}, (table)=>{\n    return {\n        pk: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_7__.primaryKey)({\n            columns: [\n                table.chatId,\n                table.messageId\n            ]\n        })\n    };\n});\nconst document = (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.pgTable)(\"Document\", {\n    id: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__.uuid)(\"id\").notNull().defaultRandom(),\n    createdAt: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_3__.timestamp)(\"createdAt\").notNull(),\n    title: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__.text)(\"title\").notNull(),\n    content: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__.text)(\"content\"),\n    kind: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_2__.varchar)(\"text\", {\n        enum: [\n            \"text\",\n            \"code\",\n            \"image\",\n            \"sheet\"\n        ]\n    }).notNull().default(\"text\"),\n    userId: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__.uuid)(\"userId\").notNull().references(()=>user.id)\n}, (table)=>{\n    return {\n        pk: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_7__.primaryKey)({\n            columns: [\n                table.id,\n                table.createdAt\n            ]\n        })\n    };\n});\nconst suggestion = (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.pgTable)(\"Suggestion\", {\n    id: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__.uuid)(\"id\").notNull().defaultRandom(),\n    documentId: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__.uuid)(\"documentId\").notNull(),\n    documentCreatedAt: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_3__.timestamp)(\"documentCreatedAt\").notNull(),\n    originalText: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__.text)(\"originalText\").notNull(),\n    suggestedText: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__.text)(\"suggestedText\").notNull(),\n    description: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_4__.text)(\"description\"),\n    isResolved: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_6__.boolean)(\"isResolved\").notNull().default(false),\n    userId: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__.uuid)(\"userId\").notNull().references(()=>user.id),\n    createdAt: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_3__.timestamp)(\"createdAt\").notNull()\n}, (table)=>({\n        pk: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_7__.primaryKey)({\n            columns: [\n                table.id\n            ]\n        }),\n        documentRef: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_8__.foreignKey)({\n            columns: [\n                table.documentId,\n                table.documentCreatedAt\n            ],\n            foreignColumns: [\n                document.id,\n                document.createdAt\n            ]\n        })\n    }));\nconst stream = (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_0__.pgTable)(\"Stream\", {\n    id: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__.uuid)(\"id\").notNull().defaultRandom(),\n    chatId: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_1__.uuid)(\"chatId\").notNull(),\n    createdAt: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_3__.timestamp)(\"createdAt\").notNull()\n}, (table)=>({\n        pk: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_7__.primaryKey)({\n            columns: [\n                table.id\n            ]\n        }),\n        chatRef: (0,drizzle_orm_pg_core__WEBPACK_IMPORTED_MODULE_8__.foreignKey)({\n            columns: [\n                table.chatId\n            ],\n            foreignColumns: [\n                chat.id\n            ]\n        })\n    }));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TztJQUM1Q2tDLGFBQWF4Qyx5REFBSUEsQ0FBQztJQUNsQnlDLFlBQVk5Qyw0REFBT0EsQ0FBQyxjQUFjVyxPQUFPLEdBQUdZLE9BQU8sQ0FBQztJQUNwREosUUFBUVoseURBQUlBLENBQUMsVUFDVkksT0FBTyxHQUNQUyxVQUFVLENBQUMsSUFBTVgsS0FBS0MsRUFBRTtJQUMzQk8sV0FBV1gsOERBQVNBLENBQUMsYUFBYUssT0FBTztBQUMzQyxHQUNBLENBQUN1QixRQUFXO1FBQ1ZDLElBQUkvQiwrREFBVUEsQ0FBQztZQUFFZ0MsU0FBUztnQkFBQ0YsTUFBTXhCLEVBQUU7YUFBQztRQUFDO1FBQ3JDcUMsYUFBYTlDLCtEQUFVQSxDQUFDO1lBQ3RCbUMsU0FBUztnQkFBQ0YsTUFBTU8sVUFBVTtnQkFBRVAsTUFBTVEsaUJBQWlCO2FBQUM7WUFDcERNLGdCQUFnQjtnQkFBQ1YsU0FBUzVCLEVBQUU7Z0JBQUU0QixTQUFTckIsU0FBUzthQUFDO1FBQ25EO0lBQ0YsSUFDQTtBQUlLLE1BQU1nQyxTQUFTOUMsNERBQU9BLENBQzNCLFVBQ0E7SUFDRU8sSUFBSUgseURBQUlBLENBQUMsTUFBTUksT0FBTyxHQUFHQyxhQUFhO0lBQ3RDYSxRQUFRbEIseURBQUlBLENBQUMsVUFBVUksT0FBTztJQUM5Qk0sV0FBV1gsOERBQVNBLENBQUMsYUFBYUssT0FBTztBQUMzQyxHQUNBLENBQUN1QixRQUFXO1FBQ1ZDLElBQUkvQiwrREFBVUEsQ0FBQztZQUFFZ0MsU0FBUztnQkFBQ0YsTUFBTXhCLEVBQUU7YUFBQztRQUFDO1FBQ3JDd0MsU0FBU2pELCtEQUFVQSxDQUFDO1lBQ2xCbUMsU0FBUztnQkFBQ0YsTUFBTVQsTUFBTTthQUFDO1lBQ3ZCdUIsZ0JBQWdCO2dCQUFDaEMsS0FBS04sRUFBRTthQUFDO1FBQzNCO0lBQ0YsSUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL3NlbnRpbmVsLWZyb250ZW5kLy4vbGliL2RiL3NjaGVtYS50cz8yZjZiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB0eXBlIHsgSW5mZXJTZWxlY3RNb2RlbCB9IGZyb20gXCJkcml6emxlLW9ybVwiO1xuaW1wb3J0IHtcbiAgYm9vbGVhbixcbiAgZm9yZWlnbktleSxcbiAganNvbixcbiAgcGdUYWJsZSxcbiAgcHJpbWFyeUtleSxcbiAgdGV4dCxcbiAgdGltZXN0YW1wLFxuICB1dWlkLFxuICB2YXJjaGFyLFxufSBmcm9tIFwiZHJpenpsZS1vcm0vcGctY29yZVwiO1xuXG5leHBvcnQgY29uc3QgdXNlciA9IHBnVGFibGUoXCJVc2VyXCIsIHtcbiAgaWQ6IHV1aWQoXCJpZFwiKS5wcmltYXJ5S2V5KCkubm90TnVsbCgpLmRlZmF1bHRSYW5kb20oKSxcbiAgZW1haWw6IHZhcmNoYXIoXCJlbWFpbFwiLCB7IGxlbmd0aDogNjQgfSkubm90TnVsbCgpLFxuICBwYXNzd29yZDogdmFyY2hhcihcInBhc3N3b3JkXCIsIHsgbGVuZ3RoOiA2NCB9KSxcbn0pO1xuXG5leHBvcnQgdHlwZSBVc2VyID0gSW5mZXJTZWxlY3RNb2RlbDx0eXBlb2YgdXNlcj47XG5cbmV4cG9ydCBjb25zdCBjaGF0ID0gcGdUYWJsZShcIkNoYXRcIiwge1xuICBpZDogdXVpZChcImlkXCIpLnByaW1hcnlLZXkoKS5ub3ROdWxsKCkuZGVmYXVsdFJhbmRvbSgpLFxuICBjcmVhdGVkQXQ6IHRpbWVzdGFtcChcImNyZWF0ZWRBdFwiKS5ub3ROdWxsKCksXG4gIHRpdGxlOiB0ZXh0KFwidGl0bGVcIikubm90TnVsbCgpLFxuICB1c2VySWQ6IHV1aWQoXCJ1c2VySWRcIilcbiAgICAubm90TnVsbCgpXG4gICAgLnJlZmVyZW5jZXMoKCkgPT4gdXNlci5pZCksXG4gIHZpc2liaWxpdHk6IHZhcmNoYXIoXCJ2aXNpYmlsaXR5XCIsIHsgZW51bTogW1wicHVibGljXCIsIFwicHJpdmF0ZVwiXSB9KVxuICAgIC5ub3ROdWxsKClcbiAgICAuZGVmYXVsdChcInByaXZhdGVcIiksXG59KTtcblxuZXhwb3J0IHR5cGUgQ2hhdCA9IEluZmVyU2VsZWN0TW9kZWw8dHlwZW9mIGNoYXQ+O1xuXG4vLyBERVBSRUNBVEVEOiBUaGUgZm9sbG93aW5nIHNjaGVtYSBpcyBkZXByZWNhdGVkIGFuZCB3aWxsIGJlIHJlbW92ZWQgaW4gdGhlIGZ1dHVyZS5cbi8vIFJlYWQgdGhlIG1pZ3JhdGlvbiBndWlkZSBhdCBodHRwczovL2NoYXQtc2RrLmRldi9kb2NzL21pZ3JhdGlvbi1ndWlkZXMvbWVzc2FnZS1wYXJ0c1xuZXhwb3J0IGNvbnN0IG1lc3NhZ2VEZXByZWNhdGVkID0gcGdUYWJsZShcIk1lc3NhZ2VcIiwge1xuICBpZDogdXVpZChcImlkXCIpLnByaW1hcnlLZXkoKS5ub3ROdWxsKCkuZGVmYXVsdFJhbmRvbSgpLFxuICBjaGF0SWQ6IHV1aWQoXCJjaGF0SWRcIilcbiAgICAubm90TnVsbCgpXG4gICAgLnJlZmVyZW5jZXMoKCkgPT4gY2hhdC5pZCksXG4gIHJvbGU6IHZhcmNoYXIoXCJyb2xlXCIpLm5vdE51bGwoKSxcbiAgY29udGVudDoganNvbihcImNvbnRlbnRcIikubm90TnVsbCgpLFxuICBjcmVhdGVkQXQ6IHRpbWVzdGFtcChcImNyZWF0ZWRBdFwiKS5ub3ROdWxsKCksXG59KTtcblxuZXhwb3J0IHR5cGUgTWVzc2FnZURlcHJlY2F0ZWQgPSBJbmZlclNlbGVjdE1vZGVsPHR5cGVvZiBtZXNzYWdlRGVwcmVjYXRlZD47XG5cbmV4cG9ydCBjb25zdCBtZXNzYWdlID0gcGdUYWJsZShcIk1lc3NhZ2VfdjJcIiwge1xuICBpZDogdXVpZChcImlkXCIpLnByaW1hcnlLZXkoKS5ub3ROdWxsKCkuZGVmYXVsdFJhbmRvbSgpLFxuICBjaGF0SWQ6IHV1aWQoXCJjaGF0SWRcIilcbiAgICAubm90TnVsbCgpXG4gICAgLnJlZmVyZW5jZXMoKCkgPT4gY2hhdC5pZCksXG4gIHJvbGU6IHZhcmNoYXIoXCJyb2xlXCIpLm5vdE51bGwoKSxcbiAgcGFydHM6IGpzb24oXCJwYXJ0c1wiKS5ub3ROdWxsKCksXG4gIGF0dGFjaG1lbnRzOiBqc29uKFwiYXR0YWNobWVudHNcIikubm90TnVsbCgpLFxuICBjcmVhdGVkQXQ6IHRpbWVzdGFtcChcImNyZWF0ZWRBdFwiKS5ub3ROdWxsKCksXG59KTtcblxuZXhwb3J0IHR5cGUgREJNZXNzYWdlID0gSW5mZXJTZWxlY3RNb2RlbDx0eXBlb2YgbWVzc2FnZT47XG5cbi8vIERFUFJFQ0FURUQ6IFRoZSBmb2xsb3dpbmcgc2NoZW1hIGlzIGRlcHJlY2F0ZWQgYW5kIHdpbGwgYmUgcmVtb3ZlZCBpbiB0aGUgZnV0dXJlLlxuLy8gUmVhZCB0aGUgbWlncmF0aW9uIGd1aWRlIGF0IGh0dHBzOi8vY2hhdC1zZGsuZGV2L2RvY3MvbWlncmF0aW9uLWd1aWRlcy9tZXNzYWdlLXBhcnRzXG5leHBvcnQgY29uc3Qgdm90ZURlcHJlY2F0ZWQgPSBwZ1RhYmxlKFxuICBcIlZvdGVcIixcbiAge1xuICAgIGNoYXRJZDogdXVpZChcImNoYXRJZFwiKVxuICAgICAgLm5vdE51bGwoKVxuICAgICAgLnJlZmVyZW5jZXMoKCkgPT4gY2hhdC5pZCksXG4gICAgbWVzc2FnZUlkOiB1dWlkKFwibWVzc2FnZUlkXCIpXG4gICAgICAubm90TnVsbCgpXG4gICAgICAucmVmZXJlbmNlcygoKSA9PiBtZXNzYWdlRGVwcmVjYXRlZC5pZCksXG4gICAgaXNVcHZvdGVkOiBib29sZWFuKFwiaXNVcHZvdGVkXCIpLm5vdE51bGwoKSxcbiAgfSxcbiAgKHRhYmxlKSA9PiB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHBrOiBwcmltYXJ5S2V5KHsgY29sdW1uczogW3RhYmxlLmNoYXRJZCwgdGFibGUubWVzc2FnZUlkXSB9KSxcbiAgICB9O1xuICB9XG4pO1xuXG5leHBvcnQgdHlwZSBWb3RlRGVwcmVjYXRlZCA9IEluZmVyU2VsZWN0TW9kZWw8dHlwZW9mIHZvdGVEZXByZWNhdGVkPjtcblxuZXhwb3J0IGNvbnN0IHZvdGUgPSBwZ1RhYmxlKFxuICBcIlZvdGVfdjJcIixcbiAge1xuICAgIGNoYXRJZDogdXVpZChcImNoYXRJZFwiKVxuICAgICAgLm5vdE51bGwoKVxuICAgICAgLnJlZmVyZW5jZXMoKCkgPT4gY2hhdC5pZCksXG4gICAgbWVzc2FnZUlkOiB1dWlkKFwibWVzc2FnZUlkXCIpXG4gICAgICAubm90TnVsbCgpXG4gICAgICAucmVmZXJlbmNlcygoKSA9PiBtZXNzYWdlLmlkKSxcbiAgICBpc1Vwdm90ZWQ6IGJvb2xlYW4oXCJpc1Vwdm90ZWRcIikubm90TnVsbCgpLFxuICB9LFxuICAodGFibGUpID0+IHtcbiAgICByZXR1cm4ge1xuICAgICAgcGs6IHByaW1hcnlLZXkoeyBjb2x1bW5zOiBbdGFibGUuY2hhdElkLCB0YWJsZS5tZXNzYWdlSWRdIH0pLFxuICAgIH07XG4gIH1cbik7XG5cbmV4cG9ydCB0eXBlIFZvdGUgPSBJbmZlclNlbGVjdE1vZGVsPHR5cGVvZiB2b3RlPjtcblxuZXhwb3J0IGNvbnN0IGRvY3VtZW50ID0gcGdUYWJsZShcbiAgXCJEb2N1bWVudFwiLFxuICB7XG4gICAgaWQ6IHV1aWQoXCJpZFwiKS5ub3ROdWxsKCkuZGVmYXVsdFJhbmRvbSgpLFxuICAgIGNyZWF0ZWRBdDogdGltZXN0YW1wKFwiY3JlYXRlZEF0XCIpLm5vdE51bGwoKSxcbiAgICB0aXRsZTogdGV4dChcInRpdGxlXCIpLm5vdE51bGwoKSxcbiAgICBjb250ZW50OiB0ZXh0KFwiY29udGVudFwiKSxcbiAgICBraW5kOiB2YXJjaGFyKFwidGV4dFwiLCB7IGVudW06IFtcInRleHRcIiwgXCJjb2RlXCIsIFwiaW1hZ2VcIiwgXCJzaGVldFwiXSB9KVxuICAgICAgLm5vdE51bGwoKVxuICAgICAgLmRlZmF1bHQoXCJ0ZXh0XCIpLFxuICAgIHVzZXJJZDogdXVpZChcInVzZXJJZFwiKVxuICAgICAgLm5vdE51bGwoKVxuICAgICAgLnJlZmVyZW5jZXMoKCkgPT4gdXNlci5pZCksXG4gIH0sXG4gICh0YWJsZSkgPT4ge1xuICAgIHJldHVybiB7XG4gICAgICBwazogcHJpbWFyeUtleSh7IGNvbHVtbnM6IFt0YWJsZS5pZCwgdGFibGUuY3JlYXRlZEF0XSB9KSxcbiAgICB9O1xuICB9XG4pO1xuXG5leHBvcnQgdHlwZSBEb2N1bWVudCA9IEluZmVyU2VsZWN0TW9kZWw8dHlwZW9mIGRvY3VtZW50PjtcblxuZXhwb3J0IGNvbnN0IHN1Z2dlc3Rpb24gPSBwZ1RhYmxlKFxuICBcIlN1Z2dlc3Rpb25cIixcbiAge1xuICAgIGlkOiB1dWlkKFwiaWRcIikubm90TnVsbCgpLmRlZmF1bHRSYW5kb20oKSxcbiAgICBkb2N1bWVudElkOiB1dWlkKFwiZG9jdW1lbnRJZFwiKS5ub3ROdWxsKCksXG4gICAgZG9jdW1lbnRDcmVhdGVkQXQ6IHRpbWVzdGFtcChcImRvY3VtZW50Q3JlYXRlZEF0XCIpLm5vdE51bGwoKSxcbiAgICBvcmlnaW5hbFRleHQ6IHRleHQoXCJvcmlnaW5hbFRleHRcIikubm90TnVsbCgpLFxuICAgIHN1Z2dlc3RlZFRleHQ6IHRleHQoXCJzdWdnZXN0ZWRUZXh0XCIpLm5vdE51bGwoKSxcbiAgICBkZXNjcmlwdGlvbjogdGV4dChcImRlc2NyaXB0aW9uXCIpLFxuICAgIGlzUmVzb2x2ZWQ6IGJvb2xlYW4oXCJpc1Jlc29sdmVkXCIpLm5vdE51bGwoKS5kZWZhdWx0KGZhbHNlKSxcbiAgICB1c2VySWQ6IHV1aWQoXCJ1c2VySWRcIilcbiAgICAgIC5ub3ROdWxsKClcbiAgICAgIC5yZWZlcmVuY2VzKCgpID0+IHVzZXIuaWQpLFxuICAgIGNyZWF0ZWRBdDogdGltZXN0YW1wKFwiY3JlYXRlZEF0XCIpLm5vdE51bGwoKSxcbiAgfSxcbiAgKHRhYmxlKSA9PiAoe1xuICAgIHBrOiBwcmltYXJ5S2V5KHsgY29sdW1uczogW3RhYmxlLmlkXSB9KSxcbiAgICBkb2N1bWVudFJlZjogZm9yZWlnbktleSh7XG4gICAgICBjb2x1bW5zOiBbdGFibGUuZG9jdW1lbnRJZCwgdGFibGUuZG9jdW1lbnRDcmVhdGVkQXRdLFxuICAgICAgZm9yZWlnbkNvbHVtbnM6IFtkb2N1bWVudC5pZCwgZG9jdW1lbnQuY3JlYXRlZEF0XSxcbiAgICB9KSxcbiAgfSlcbik7XG5cbmV4cG9ydCB0eXBlIFN1Z2dlc3Rpb24gPSBJbmZlclNlbGVjdE1vZGVsPHR5cGVvZiBzdWdnZXN0aW9uPjtcblxuZXhwb3J0IGNvbnN0IHN0cmVhbSA9IHBnVGFibGUoXG4gIFwiU3RyZWFtXCIsXG4gIHtcbiAgICBpZDogdXVpZChcImlkXCIpLm5vdE51bGwoKS5kZWZhdWx0UmFuZG9tKCksXG4gICAgY2hhdElkOiB1dWlkKFwiY2hhdElkXCIpLm5vdE51bGwoKSxcbiAgICBjcmVhdGVkQXQ6IHRpbWVzdGFtcChcImNyZWF0ZWRBdFwiKS5ub3ROdWxsKCksXG4gIH0sXG4gICh0YWJsZSkgPT4gKHtcbiAgICBwazogcHJpbWFyeUtleSh7IGNvbHVtbnM6IFt0YWJsZS5pZF0gfSksXG4gICAgY2hhdFJlZjogZm9yZWlnbktleSh7XG4gICAgICBjb2x1bW5zOiBbdGFibGUuY2hhdElkXSxcbiAgICAgIGZvcmVpZ25Db2x1bW5zOiBbY2hhdC5pZF0sXG4gICAgfSksXG4gIH0pXG4pO1xuXG5leHBvcnQgdHlwZSBTdHJlYW0gPSBJbmZlclNlbGVjdE1vZGVsPHR5cGVvZiBzdHJlYW0+O1xuIl0sIm5hbWVzIjpbImJvb2xlYW4iLCJmb3JlaWduS2V5IiwianNvbiIsInBnVGFibGUiLCJwcmltYXJ5S2V5IiwidGV4dCIsInRpbWVzdGFtcCIsInV1aWQiLCJ2YXJjaGFyIiwidXNlciIsImlkIiwibm90TnVsbCIsImRlZmF1bHRSYW5kb20iLCJlbWFpbCIsImxlbmd0aCIsInBhc3N3b3JkIiwiY2hhdCIsImNyZWF0ZWRBdCIsInRpdGxlIiwidXNlcklkIiwicmVmZXJlbmNlcyIsInZpc2liaWxpdHkiLCJlbnVtIiwiZGVmYXVsdCIsIm1lc3NhZ2VEZXByZWNhdGVkIiwiY2hhdElkIiwicm9sZSIsImNvbnRlbnQiLCJtZXNzYWdlIiwicGFydHMiLCJhdHRhY2htZW50cyIsInZvdGVEZXByZWNhdGVkIiwibWVzc2FnZUlkIiwiaXNVcHZvdGVkIiwidGFibGUiLCJwayIsImNvbHVtbnMiLCJ2b3RlIiwiZG9jdW1lbnQiLCJraW5kIiwic3VnZ2VzdGlvbiIsImRvY3VtZW50SWQiLCJkb2N1bWVudENyZWF0ZWRBdCIsIm9yaWdpbmFsVGV4dCIsInN1Z2dlc3RlZFRleHQiLCJkZXNjcmlwdGlvbiIsImlzUmVzb2x2ZWQiLCJkb2N1bWVudFJlZiIsImZvcmVpZ25Db2x1bW5zIiwic3RyZWFtIiwiY2hhdFJlZiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/db/schema.ts\n");

/***/ }),

/***/ "(rsc)/./lib/db/utils.ts":
/*!*************************!*\
  !*** ./lib/db/utils.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   generateDummyPassword: () => (/* binding */ generateDummyPassword),\n/* harmony export */   generateHashedPassword: () => (/* binding */ generateHashedPassword)\n/* harmony export */ });\n/* harmony import */ var ai__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ai */ \"(rsc)/./node_modules/.pnpm/ai@3.4.33_react@18.3.1_sswr_af653c0b93f68119aa4870059e5b1a60/node_modules/ai/dist/index.mjs\");\n/* harmony import */ var bcrypt_ts__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! bcrypt-ts */ \"(rsc)/./node_modules/.pnpm/bcrypt-ts@8.0.0/node_modules/bcrypt-ts/dist/node.js\");\n\n\nfunction generateHashedPassword(password) {\n    const salt = (0,bcrypt_ts__WEBPACK_IMPORTED_MODULE_0__.genSaltSync)(10);\n    const hash = (0,bcrypt_ts__WEBPACK_IMPORTED_MODULE_0__.hashSync)(password, salt);\n    return hash;\n}\nfunction generateDummyPassword() {\n    const password = (0,ai__WEBPACK_IMPORTED_MODULE_1__.generateId)();\n    const hashedPassword = generateHashedPassword(password);\n    return hashedPassword;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvZGIvdXRpbHMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFnQztBQUNrQjtBQUUzQyxTQUFTRyx1QkFBdUJDLFFBQWdCO0lBQ3JELE1BQU1DLE9BQU9KLHNEQUFXQSxDQUFDO0lBQ3pCLE1BQU1LLE9BQU9KLG1EQUFRQSxDQUFDRSxVQUFVQztJQUVoQyxPQUFPQztBQUNUO0FBRU8sU0FBU0M7SUFDZCxNQUFNSCxXQUFXSiw4Q0FBVUE7SUFDM0IsTUFBTVEsaUJBQWlCTCx1QkFBdUJDO0lBRTlDLE9BQU9JO0FBQ1QiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZW50aW5lbC1mcm9udGVuZC8uL2xpYi9kYi91dGlscy50cz85YTM1Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdlbmVyYXRlSWQgfSBmcm9tIFwiYWlcIjtcbmltcG9ydCB7IGdlblNhbHRTeW5jLCBoYXNoU3luYyB9IGZyb20gXCJiY3J5cHQtdHNcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIGdlbmVyYXRlSGFzaGVkUGFzc3dvcmQocGFzc3dvcmQ6IHN0cmluZykge1xuICBjb25zdCBzYWx0ID0gZ2VuU2FsdFN5bmMoMTApO1xuICBjb25zdCBoYXNoID0gaGFzaFN5bmMocGFzc3dvcmQsIHNhbHQpO1xuXG4gIHJldHVybiBoYXNoO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2VuZXJhdGVEdW1teVBhc3N3b3JkKCkge1xuICBjb25zdCBwYXNzd29yZCA9IGdlbmVyYXRlSWQoKTtcbiAgY29uc3QgaGFzaGVkUGFzc3dvcmQgPSBnZW5lcmF0ZUhhc2hlZFBhc3N3b3JkKHBhc3N3b3JkKTtcblxuICByZXR1cm4gaGFzaGVkUGFzc3dvcmQ7XG59XG4iXSwibmFtZXMiOlsiZ2VuZXJhdGVJZCIsImdlblNhbHRTeW5jIiwiaGFzaFN5bmMiLCJnZW5lcmF0ZUhhc2hlZFBhc3N3b3JkIiwicGFzc3dvcmQiLCJzYWx0IiwiaGFzaCIsImdlbmVyYXRlRHVtbXlQYXNzd29yZCIsImhhc2hlZFBhc3N3b3JkIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/db/utils.ts\n");

/***/ }),

/***/ "(rsc)/./lib/errors.ts":
/*!***********************!*\
  !*** ./lib/errors.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ChatSDKError: () => (/* binding */ ChatSDKError),\n/* harmony export */   getMessageByErrorCode: () => (/* binding */ getMessageByErrorCode),\n/* harmony export */   visibilityBySurface: () => (/* binding */ visibilityBySurface)\n/* harmony export */ });\nconst visibilityBySurface = {\n    database: \"log\",\n    chat: \"response\",\n    auth: \"response\",\n    stream: \"response\",\n    api: \"response\",\n    history: \"response\",\n    vote: \"response\",\n    document: \"response\",\n    suggestions: \"response\",\n    activate_gateway: \"response\"\n};\nclass ChatSDKError extends Error {\n    constructor(errorCode, cause){\n        super();\n        const [type, surface] = errorCode.split(\":\");\n        this.type = type;\n        this.cause = cause;\n        this.surface = surface;\n        this.message = getMessageByErrorCode(errorCode);\n        this.statusCode = getStatusCodeByType(this.type);\n    }\n    toResponse() {\n        const code = `${this.type}:${this.surface}`;\n        const visibility = visibilityBySurface[this.surface];\n        const { message, cause, statusCode } = this;\n        if (visibility === \"log\") {\n            console.error({\n                code,\n                message,\n                cause\n            });\n            return Response.json({\n                code: \"\",\n                message: \"Something went wrong. Please try again later.\"\n            }, {\n                status: statusCode\n            });\n        }\n        return Response.json({\n            code,\n            message,\n            cause\n        }, {\n            status: statusCode\n        });\n    }\n}\nfunction getMessageByErrorCode(errorCode) {\n    if (errorCode.includes(\"database\")) {\n        return \"An error occurred while executing a database query.\";\n    }\n    switch(errorCode){\n        case \"bad_request:api\":\n            return \"The request couldn't be processed. Please check your input and try again.\";\n        case \"bad_request:activate_gateway\":\n            return \"AI Gateway requires a valid credit card on file to service requests. Please visit https://vercel.com/d?to=%2F%5Bteam%5D%2F%7E%2Fai%3Fmodal%3Dadd-credit-card to add a card and unlock your free credits.\";\n        case \"unauthorized:auth\":\n            return \"You need to sign in before continuing.\";\n        case \"forbidden:auth\":\n            return \"Your account does not have access to this feature.\";\n        case \"rate_limit:chat\":\n            return \"You have exceeded your maximum number of messages for the day. Please try again later.\";\n        case \"not_found:chat\":\n            return \"The requested chat was not found. Please check the chat ID and try again.\";\n        case \"forbidden:chat\":\n            return \"This chat belongs to another user. Please check the chat ID and try again.\";\n        case \"unauthorized:chat\":\n            return \"You need to sign in to view this chat. Please sign in and try again.\";\n        case \"offline:chat\":\n            return \"We're having trouble sending your message. Please check your internet connection and try again.\";\n        case \"not_found:document\":\n            return \"The requested document was not found. Please check the document ID and try again.\";\n        case \"forbidden:document\":\n            return \"This document belongs to another user. Please check the document ID and try again.\";\n        case \"unauthorized:document\":\n            return \"You need to sign in to view this document. Please sign in and try again.\";\n        case \"bad_request:document\":\n            return \"The request to create or update the document was invalid. Please check your input and try again.\";\n        default:\n            return \"Something went wrong. Please try again later.\";\n    }\n}\nfunction getStatusCodeByType(type) {\n    switch(type){\n        case \"bad_request\":\n            return 400;\n        case \"unauthorized\":\n            return 401;\n        case \"forbidden\":\n            return 403;\n        case \"not_found\":\n            return 404;\n        case \"rate_limit\":\n            return 429;\n        case \"offline\":\n            return 503;\n        default:\n            return 500;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvZXJyb3JzLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQXdCTyxNQUFNQSxzQkFBd0Q7SUFDbkVDLFVBQVU7SUFDVkMsTUFBTTtJQUNOQyxNQUFNO0lBQ05DLFFBQVE7SUFDUkMsS0FBSztJQUNMQyxTQUFTO0lBQ1RDLE1BQU07SUFDTkMsVUFBVTtJQUNWQyxhQUFhO0lBQ2JDLGtCQUFrQjtBQUNwQixFQUFFO0FBRUssTUFBTUMscUJBQXFCQztJQUtoQ0MsWUFBWUMsU0FBb0IsRUFBRUMsS0FBYyxDQUFFO1FBQ2hELEtBQUs7UUFFTCxNQUFNLENBQUNDLE1BQU1DLFFBQVEsR0FBR0gsVUFBVUksS0FBSyxDQUFDO1FBRXhDLElBQUksQ0FBQ0YsSUFBSSxHQUFHQTtRQUNaLElBQUksQ0FBQ0QsS0FBSyxHQUFHQTtRQUNiLElBQUksQ0FBQ0UsT0FBTyxHQUFHQTtRQUNmLElBQUksQ0FBQ0UsT0FBTyxHQUFHQyxzQkFBc0JOO1FBQ3JDLElBQUksQ0FBQ08sVUFBVSxHQUFHQyxvQkFBb0IsSUFBSSxDQUFDTixJQUFJO0lBQ2pEO0lBRUFPLGFBQWE7UUFDWCxNQUFNQyxPQUFrQixDQUFDLEVBQUUsSUFBSSxDQUFDUixJQUFJLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQ0MsT0FBTyxDQUFDLENBQUM7UUFDdEQsTUFBTVEsYUFBYXpCLG1CQUFtQixDQUFDLElBQUksQ0FBQ2lCLE9BQU8sQ0FBQztRQUVwRCxNQUFNLEVBQUVFLE9BQU8sRUFBRUosS0FBSyxFQUFFTSxVQUFVLEVBQUUsR0FBRyxJQUFJO1FBRTNDLElBQUlJLGVBQWUsT0FBTztZQUN4QkMsUUFBUUMsS0FBSyxDQUFDO2dCQUNaSDtnQkFDQUw7Z0JBQ0FKO1lBQ0Y7WUFFQSxPQUFPYSxTQUFTQyxJQUFJLENBQ2xCO2dCQUFFTCxNQUFNO2dCQUFJTCxTQUFTO1lBQWdELEdBQ3JFO2dCQUFFVyxRQUFRVDtZQUFXO1FBRXpCO1FBRUEsT0FBT08sU0FBU0MsSUFBSSxDQUFDO1lBQUVMO1lBQU1MO1lBQVNKO1FBQU0sR0FBRztZQUFFZSxRQUFRVDtRQUFXO0lBQ3RFO0FBQ0Y7QUFFTyxTQUFTRCxzQkFBc0JOLFNBQW9CO0lBQ3hELElBQUlBLFVBQVVpQixRQUFRLENBQUMsYUFBYTtRQUNsQyxPQUFPO0lBQ1Q7SUFFQSxPQUFRakI7UUFDTixLQUFLO1lBQ0gsT0FBTztRQUVULEtBQUs7WUFDSCxPQUFPO1FBRVQsS0FBSztZQUNILE9BQU87UUFDVCxLQUFLO1lBQ0gsT0FBTztRQUVULEtBQUs7WUFDSCxPQUFPO1FBQ1QsS0FBSztZQUNILE9BQU87UUFDVCxLQUFLO1lBQ0gsT0FBTztRQUNULEtBQUs7WUFDSCxPQUFPO1FBQ1QsS0FBSztZQUNILE9BQU87UUFFVCxLQUFLO1lBQ0gsT0FBTztRQUNULEtBQUs7WUFDSCxPQUFPO1FBQ1QsS0FBSztZQUNILE9BQU87UUFDVCxLQUFLO1lBQ0gsT0FBTztRQUVUO1lBQ0UsT0FBTztJQUNYO0FBQ0Y7QUFFQSxTQUFTUSxvQkFBb0JOLElBQWU7SUFDMUMsT0FBUUE7UUFDTixLQUFLO1lBQ0gsT0FBTztRQUNULEtBQUs7WUFDSCxPQUFPO1FBQ1QsS0FBSztZQUNILE9BQU87UUFDVCxLQUFLO1lBQ0gsT0FBTztRQUNULEtBQUs7WUFDSCxPQUFPO1FBQ1QsS0FBSztZQUNILE9BQU87UUFDVDtZQUNFLE9BQU87SUFDWDtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VudGluZWwtZnJvbnRlbmQvLi9saWIvZXJyb3JzLnRzPzM2ZmIiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IHR5cGUgRXJyb3JUeXBlID1cbiAgfCBcImJhZF9yZXF1ZXN0XCJcbiAgfCBcInVuYXV0aG9yaXplZFwiXG4gIHwgXCJmb3JiaWRkZW5cIlxuICB8IFwibm90X2ZvdW5kXCJcbiAgfCBcInJhdGVfbGltaXRcIlxuICB8IFwib2ZmbGluZVwiO1xuXG5leHBvcnQgdHlwZSBTdXJmYWNlID1cbiAgfCBcImNoYXRcIlxuICB8IFwiYXV0aFwiXG4gIHwgXCJhcGlcIlxuICB8IFwic3RyZWFtXCJcbiAgfCBcImRhdGFiYXNlXCJcbiAgfCBcImhpc3RvcnlcIlxuICB8IFwidm90ZVwiXG4gIHwgXCJkb2N1bWVudFwiXG4gIHwgXCJzdWdnZXN0aW9uc1wiXG4gIHwgXCJhY3RpdmF0ZV9nYXRld2F5XCI7XG5cbmV4cG9ydCB0eXBlIEVycm9yQ29kZSA9IGAke0Vycm9yVHlwZX06JHtTdXJmYWNlfWA7XG5cbmV4cG9ydCB0eXBlIEVycm9yVmlzaWJpbGl0eSA9IFwicmVzcG9uc2VcIiB8IFwibG9nXCIgfCBcIm5vbmVcIjtcblxuZXhwb3J0IGNvbnN0IHZpc2liaWxpdHlCeVN1cmZhY2U6IFJlY29yZDxTdXJmYWNlLCBFcnJvclZpc2liaWxpdHk+ID0ge1xuICBkYXRhYmFzZTogXCJsb2dcIixcbiAgY2hhdDogXCJyZXNwb25zZVwiLFxuICBhdXRoOiBcInJlc3BvbnNlXCIsXG4gIHN0cmVhbTogXCJyZXNwb25zZVwiLFxuICBhcGk6IFwicmVzcG9uc2VcIixcbiAgaGlzdG9yeTogXCJyZXNwb25zZVwiLFxuICB2b3RlOiBcInJlc3BvbnNlXCIsXG4gIGRvY3VtZW50OiBcInJlc3BvbnNlXCIsXG4gIHN1Z2dlc3Rpb25zOiBcInJlc3BvbnNlXCIsXG4gIGFjdGl2YXRlX2dhdGV3YXk6IFwicmVzcG9uc2VcIixcbn07XG5cbmV4cG9ydCBjbGFzcyBDaGF0U0RLRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gIHR5cGU6IEVycm9yVHlwZTtcbiAgc3VyZmFjZTogU3VyZmFjZTtcbiAgc3RhdHVzQ29kZTogbnVtYmVyO1xuXG4gIGNvbnN0cnVjdG9yKGVycm9yQ29kZTogRXJyb3JDb2RlLCBjYXVzZT86IHN0cmluZykge1xuICAgIHN1cGVyKCk7XG5cbiAgICBjb25zdCBbdHlwZSwgc3VyZmFjZV0gPSBlcnJvckNvZGUuc3BsaXQoXCI6XCIpO1xuXG4gICAgdGhpcy50eXBlID0gdHlwZSBhcyBFcnJvclR5cGU7XG4gICAgdGhpcy5jYXVzZSA9IGNhdXNlO1xuICAgIHRoaXMuc3VyZmFjZSA9IHN1cmZhY2UgYXMgU3VyZmFjZTtcbiAgICB0aGlzLm1lc3NhZ2UgPSBnZXRNZXNzYWdlQnlFcnJvckNvZGUoZXJyb3JDb2RlKTtcbiAgICB0aGlzLnN0YXR1c0NvZGUgPSBnZXRTdGF0dXNDb2RlQnlUeXBlKHRoaXMudHlwZSk7XG4gIH1cblxuICB0b1Jlc3BvbnNlKCkge1xuICAgIGNvbnN0IGNvZGU6IEVycm9yQ29kZSA9IGAke3RoaXMudHlwZX06JHt0aGlzLnN1cmZhY2V9YDtcbiAgICBjb25zdCB2aXNpYmlsaXR5ID0gdmlzaWJpbGl0eUJ5U3VyZmFjZVt0aGlzLnN1cmZhY2VdO1xuXG4gICAgY29uc3QgeyBtZXNzYWdlLCBjYXVzZSwgc3RhdHVzQ29kZSB9ID0gdGhpcztcblxuICAgIGlmICh2aXNpYmlsaXR5ID09PSBcImxvZ1wiKSB7XG4gICAgICBjb25zb2xlLmVycm9yKHtcbiAgICAgICAgY29kZSxcbiAgICAgICAgbWVzc2FnZSxcbiAgICAgICAgY2F1c2UsXG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgY29kZTogXCJcIiwgbWVzc2FnZTogXCJTb21ldGhpbmcgd2VudCB3cm9uZy4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlci5cIiB9LFxuICAgICAgICB7IHN0YXR1czogc3RhdHVzQ29kZSB9XG4gICAgICApO1xuICAgIH1cblxuICAgIHJldHVybiBSZXNwb25zZS5qc29uKHsgY29kZSwgbWVzc2FnZSwgY2F1c2UgfSwgeyBzdGF0dXM6IHN0YXR1c0NvZGUgfSk7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldE1lc3NhZ2VCeUVycm9yQ29kZShlcnJvckNvZGU6IEVycm9yQ29kZSk6IHN0cmluZyB7XG4gIGlmIChlcnJvckNvZGUuaW5jbHVkZXMoXCJkYXRhYmFzZVwiKSkge1xuICAgIHJldHVybiBcIkFuIGVycm9yIG9jY3VycmVkIHdoaWxlIGV4ZWN1dGluZyBhIGRhdGFiYXNlIHF1ZXJ5LlwiO1xuICB9XG5cbiAgc3dpdGNoIChlcnJvckNvZGUpIHtcbiAgICBjYXNlIFwiYmFkX3JlcXVlc3Q6YXBpXCI6XG4gICAgICByZXR1cm4gXCJUaGUgcmVxdWVzdCBjb3VsZG4ndCBiZSBwcm9jZXNzZWQuIFBsZWFzZSBjaGVjayB5b3VyIGlucHV0IGFuZCB0cnkgYWdhaW4uXCI7XG5cbiAgICBjYXNlIFwiYmFkX3JlcXVlc3Q6YWN0aXZhdGVfZ2F0ZXdheVwiOlxuICAgICAgcmV0dXJuIFwiQUkgR2F0ZXdheSByZXF1aXJlcyBhIHZhbGlkIGNyZWRpdCBjYXJkIG9uIGZpbGUgdG8gc2VydmljZSByZXF1ZXN0cy4gUGxlYXNlIHZpc2l0IGh0dHBzOi8vdmVyY2VsLmNvbS9kP3RvPSUyRiU1QnRlYW0lNUQlMkYlN0UlMkZhaSUzRm1vZGFsJTNEYWRkLWNyZWRpdC1jYXJkIHRvIGFkZCBhIGNhcmQgYW5kIHVubG9jayB5b3VyIGZyZWUgY3JlZGl0cy5cIjtcblxuICAgIGNhc2UgXCJ1bmF1dGhvcml6ZWQ6YXV0aFwiOlxuICAgICAgcmV0dXJuIFwiWW91IG5lZWQgdG8gc2lnbiBpbiBiZWZvcmUgY29udGludWluZy5cIjtcbiAgICBjYXNlIFwiZm9yYmlkZGVuOmF1dGhcIjpcbiAgICAgIHJldHVybiBcIllvdXIgYWNjb3VudCBkb2VzIG5vdCBoYXZlIGFjY2VzcyB0byB0aGlzIGZlYXR1cmUuXCI7XG5cbiAgICBjYXNlIFwicmF0ZV9saW1pdDpjaGF0XCI6XG4gICAgICByZXR1cm4gXCJZb3UgaGF2ZSBleGNlZWRlZCB5b3VyIG1heGltdW0gbnVtYmVyIG9mIG1lc3NhZ2VzIGZvciB0aGUgZGF5LiBQbGVhc2UgdHJ5IGFnYWluIGxhdGVyLlwiO1xuICAgIGNhc2UgXCJub3RfZm91bmQ6Y2hhdFwiOlxuICAgICAgcmV0dXJuIFwiVGhlIHJlcXVlc3RlZCBjaGF0IHdhcyBub3QgZm91bmQuIFBsZWFzZSBjaGVjayB0aGUgY2hhdCBJRCBhbmQgdHJ5IGFnYWluLlwiO1xuICAgIGNhc2UgXCJmb3JiaWRkZW46Y2hhdFwiOlxuICAgICAgcmV0dXJuIFwiVGhpcyBjaGF0IGJlbG9uZ3MgdG8gYW5vdGhlciB1c2VyLiBQbGVhc2UgY2hlY2sgdGhlIGNoYXQgSUQgYW5kIHRyeSBhZ2Fpbi5cIjtcbiAgICBjYXNlIFwidW5hdXRob3JpemVkOmNoYXRcIjpcbiAgICAgIHJldHVybiBcIllvdSBuZWVkIHRvIHNpZ24gaW4gdG8gdmlldyB0aGlzIGNoYXQuIFBsZWFzZSBzaWduIGluIGFuZCB0cnkgYWdhaW4uXCI7XG4gICAgY2FzZSBcIm9mZmxpbmU6Y2hhdFwiOlxuICAgICAgcmV0dXJuIFwiV2UncmUgaGF2aW5nIHRyb3VibGUgc2VuZGluZyB5b3VyIG1lc3NhZ2UuIFBsZWFzZSBjaGVjayB5b3VyIGludGVybmV0IGNvbm5lY3Rpb24gYW5kIHRyeSBhZ2Fpbi5cIjtcblxuICAgIGNhc2UgXCJub3RfZm91bmQ6ZG9jdW1lbnRcIjpcbiAgICAgIHJldHVybiBcIlRoZSByZXF1ZXN0ZWQgZG9jdW1lbnQgd2FzIG5vdCBmb3VuZC4gUGxlYXNlIGNoZWNrIHRoZSBkb2N1bWVudCBJRCBhbmQgdHJ5IGFnYWluLlwiO1xuICAgIGNhc2UgXCJmb3JiaWRkZW46ZG9jdW1lbnRcIjpcbiAgICAgIHJldHVybiBcIlRoaXMgZG9jdW1lbnQgYmVsb25ncyB0byBhbm90aGVyIHVzZXIuIFBsZWFzZSBjaGVjayB0aGUgZG9jdW1lbnQgSUQgYW5kIHRyeSBhZ2Fpbi5cIjtcbiAgICBjYXNlIFwidW5hdXRob3JpemVkOmRvY3VtZW50XCI6XG4gICAgICByZXR1cm4gXCJZb3UgbmVlZCB0byBzaWduIGluIHRvIHZpZXcgdGhpcyBkb2N1bWVudC4gUGxlYXNlIHNpZ24gaW4gYW5kIHRyeSBhZ2Fpbi5cIjtcbiAgICBjYXNlIFwiYmFkX3JlcXVlc3Q6ZG9jdW1lbnRcIjpcbiAgICAgIHJldHVybiBcIlRoZSByZXF1ZXN0IHRvIGNyZWF0ZSBvciB1cGRhdGUgdGhlIGRvY3VtZW50IHdhcyBpbnZhbGlkLiBQbGVhc2UgY2hlY2sgeW91ciBpbnB1dCBhbmQgdHJ5IGFnYWluLlwiO1xuXG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiBcIlNvbWV0aGluZyB3ZW50IHdyb25nLiBQbGVhc2UgdHJ5IGFnYWluIGxhdGVyLlwiO1xuICB9XG59XG5cbmZ1bmN0aW9uIGdldFN0YXR1c0NvZGVCeVR5cGUodHlwZTogRXJyb3JUeXBlKSB7XG4gIHN3aXRjaCAodHlwZSkge1xuICAgIGNhc2UgXCJiYWRfcmVxdWVzdFwiOlxuICAgICAgcmV0dXJuIDQwMDtcbiAgICBjYXNlIFwidW5hdXRob3JpemVkXCI6XG4gICAgICByZXR1cm4gNDAxO1xuICAgIGNhc2UgXCJmb3JiaWRkZW5cIjpcbiAgICAgIHJldHVybiA0MDM7XG4gICAgY2FzZSBcIm5vdF9mb3VuZFwiOlxuICAgICAgcmV0dXJuIDQwNDtcbiAgICBjYXNlIFwicmF0ZV9saW1pdFwiOlxuICAgICAgcmV0dXJuIDQyOTtcbiAgICBjYXNlIFwib2ZmbGluZVwiOlxuICAgICAgcmV0dXJuIDUwMztcbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuIDUwMDtcbiAgfVxufVxuIl0sIm5hbWVzIjpbInZpc2liaWxpdHlCeVN1cmZhY2UiLCJkYXRhYmFzZSIsImNoYXQiLCJhdXRoIiwic3RyZWFtIiwiYXBpIiwiaGlzdG9yeSIsInZvdGUiLCJkb2N1bWVudCIsInN1Z2dlc3Rpb25zIiwiYWN0aXZhdGVfZ2F0ZXdheSIsIkNoYXRTREtFcnJvciIsIkVycm9yIiwiY29uc3RydWN0b3IiLCJlcnJvckNvZGUiLCJjYXVzZSIsInR5cGUiLCJzdXJmYWNlIiwic3BsaXQiLCJtZXNzYWdlIiwiZ2V0TWVzc2FnZUJ5RXJyb3JDb2RlIiwic3RhdHVzQ29kZSIsImdldFN0YXR1c0NvZGVCeVR5cGUiLCJ0b1Jlc3BvbnNlIiwiY29kZSIsInZpc2liaWxpdHkiLCJjb25zb2xlIiwiZXJyb3IiLCJSZXNwb25zZSIsImpzb24iLCJzdGF0dXMiLCJpbmNsdWRlcyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/errors.ts\n");

/***/ }),

/***/ "(rsc)/./lib/utils.ts":
/*!**********************!*\
  !*** ./lib/utils.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   cn: () => (/* binding */ cn),\n/* harmony export */   convertToUIMessages: () => (/* binding */ convertToUIMessages),\n/* harmony export */   fetchWithErrorHandlers: () => (/* binding */ fetchWithErrorHandlers),\n/* harmony export */   fetcher: () => (/* binding */ fetcher),\n/* harmony export */   generateUUID: () => (/* binding */ generateUUID),\n/* harmony export */   getDocumentTimestampByIndex: () => (/* binding */ getDocumentTimestampByIndex),\n/* harmony export */   getLocalStorage: () => (/* binding */ getLocalStorage),\n/* harmony export */   getMostRecentUserMessage: () => (/* binding */ getMostRecentUserMessage),\n/* harmony export */   getTextFromMessage: () => (/* binding */ getTextFromMessage),\n/* harmony export */   getTrailingMessageId: () => (/* binding */ getTrailingMessageId),\n/* harmony export */   sanitizeText: () => (/* binding */ sanitizeText)\n/* harmony export */ });\n/* harmony import */ var clsx__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! clsx */ \"(rsc)/./node_modules/.pnpm/clsx@2.1.1/node_modules/clsx/dist/clsx.mjs\");\n/* harmony import */ var _barrel_optimize_names_formatISO_date_fns__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! __barrel_optimize__?names=formatISO!=!date-fns */ \"(rsc)/./node_modules/.pnpm/date-fns@3.6.0/node_modules/date-fns/formatISO.mjs\");\n/* harmony import */ var tailwind_merge__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! tailwind-merge */ \"(rsc)/./node_modules/.pnpm/tailwind-merge@2.6.0/node_modules/tailwind-merge/dist/bundle-mjs.mjs\");\n/* harmony import */ var _errors__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./errors */ \"(rsc)/./lib/errors.ts\");\n\n\n\n\nfunction cn(...inputs) {\n    return (0,tailwind_merge__WEBPACK_IMPORTED_MODULE_2__.twMerge)((0,clsx__WEBPACK_IMPORTED_MODULE_0__.clsx)(inputs));\n}\nconst fetcher = async (url)=>{\n    const response = await fetch(url);\n    if (!response.ok) {\n        let data = null;\n        let fallbackText;\n        try {\n            data = await response.json();\n        } catch  {\n            try {\n                fallbackText = await response.text();\n            } catch  {\n                fallbackText = undefined;\n            }\n        }\n        const code = typeof data?.code === \"string\" ? data.code : \"\";\n        const cause = typeof data?.cause === \"string\" ? data.cause : typeof data?.message === \"string\" ? data.message : fallbackText;\n        if (code) {\n            throw new _errors__WEBPACK_IMPORTED_MODULE_1__.ChatSDKError(code, cause);\n        }\n        throw new _errors__WEBPACK_IMPORTED_MODULE_1__.ChatSDKError(\"bad_request:api\", cause);\n    }\n    return response.json();\n};\nasync function fetchWithErrorHandlers(input, init) {\n    try {\n        const response = await fetch(input, init);\n        if (!response.ok) {\n            const { code, cause } = await response.json();\n            throw new _errors__WEBPACK_IMPORTED_MODULE_1__.ChatSDKError(code, cause);\n        }\n        return response;\n    } catch (error) {\n        if (typeof navigator !== \"undefined\" && !navigator.onLine) {\n            throw new _errors__WEBPACK_IMPORTED_MODULE_1__.ChatSDKError(\"offline:chat\");\n        }\n        throw error;\n    }\n}\nfunction getLocalStorage(key) {\n    if (false) {}\n    return [];\n}\nfunction generateUUID() {\n    return \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g, (c)=>{\n        const r = Math.random() * 16 | 0;\n        const v = c === \"x\" ? r : r & 0x3 | 0x8;\n        return v.toString(16);\n    });\n}\nfunction getMostRecentUserMessage(messages) {\n    const userMessages = messages.filter((message)=>message.role === \"user\");\n    return userMessages.at(-1);\n}\nfunction getDocumentTimestampByIndex(documents, index) {\n    if (!documents) {\n        return new Date();\n    }\n    if (index > documents.length) {\n        return new Date();\n    }\n    return documents[index].createdAt;\n}\nfunction getTrailingMessageId({ messages }) {\n    const trailingMessage = messages.at(-1);\n    if (!trailingMessage) {\n        return null;\n    }\n    return trailingMessage.id;\n}\nfunction sanitizeText(text) {\n    if (!text) return \"\";\n    return text.replace(\"<has_function_call>\", \"\");\n}\nfunction convertToUIMessages(messages) {\n    return messages.map((message)=>({\n            id: message.id,\n            role: message.role,\n            content: getTextFromMessage({\n                parts: message.parts\n            }),\n            parts: message.parts,\n            metadata: {\n                createdAt: (0,_barrel_optimize_names_formatISO_date_fns__WEBPACK_IMPORTED_MODULE_3__.formatISO)(message.createdAt)\n            }\n        }));\n}\nfunction getTextFromMessage(message) {\n    return message.parts.filter((part)=>part.type === \"text\").map((part)=>part.text).join(\"\");\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TztJQUNsQixPQUFPQSxLQUFLa0IsT0FBTyxDQUFDLHVCQUF1QjtBQUM3QztBQUVPLFNBQVN1QixvQkFBb0JmLFFBQXFCO0lBQ3ZELE9BQU9BLFNBQVNnQixHQUFHLENBQUMsQ0FBQ3RDLFVBQWE7WUFDaENtQyxJQUFJbkMsUUFBUW1DLEVBQUU7WUFDZFYsTUFBTXpCLFFBQVF5QixJQUFJO1lBQ2xCYyxTQUFTQyxtQkFBbUI7Z0JBQUVDLE9BQU96QyxRQUFReUMsS0FBSztZQUFDO1lBQ25EQSxPQUFPekMsUUFBUXlDLEtBQUs7WUFDcEJDLFVBQVU7Z0JBQ1JWLFdBQVdqRCxvRkFBU0EsQ0FBQ2lCLFFBQVFnQyxTQUFTO1lBQ3hDO1FBQ0Y7QUFDRjtBQUVPLFNBQVNRLG1CQUFtQnhDLE9BQWdDO0lBQ2pFLE9BQU9BLFFBQVF5QyxLQUFLLENBQ2pCakIsTUFBTSxDQUFDLENBQUNtQixPQUFTQSxLQUFLQyxJQUFJLEtBQUssUUFDL0JOLEdBQUcsQ0FBQyxDQUFDSyxPQUFTLEtBQXlDL0MsSUFBSSxFQUMzRGlELElBQUksQ0FBQztBQUNWIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VudGluZWwtZnJvbnRlbmQvLi9saWIvdXRpbHMudHM/Zjc0NSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7XG4gIEFzc2lzdGFudE1vZGVsTWVzc2FnZSxcbiAgVG9vbE1vZGVsTWVzc2FnZSxcbiAgVUlNZXNzYWdlLFxuICBVSU1lc3NhZ2VQYXJ0LFxufSBmcm9tICdhaSc7XG5pbXBvcnQgeyB0eXBlIENsYXNzVmFsdWUsIGNsc3ggfSBmcm9tICdjbHN4JztcbmltcG9ydCB7IGZvcm1hdElTTyB9IGZyb20gJ2RhdGUtZm5zJztcbmltcG9ydCB7IHR3TWVyZ2UgfSBmcm9tICd0YWlsd2luZC1tZXJnZSc7XG5pbXBvcnQgdHlwZSB7IERCTWVzc2FnZSwgRG9jdW1lbnQgfSBmcm9tICdAL2xpYi9kYi9zY2hlbWEnO1xuaW1wb3J0IHsgQ2hhdFNES0Vycm9yLCB0eXBlIEVycm9yQ29kZSB9IGZyb20gJy4vZXJyb3JzJztcbmltcG9ydCB0eXBlIHsgQ2hhdE1lc3NhZ2UsIENoYXRUb29scywgQ3VzdG9tVUlEYXRhVHlwZXMgfSBmcm9tICcuL3R5cGVzJztcblxuZXhwb3J0IGZ1bmN0aW9uIGNuKC4uLmlucHV0czogQ2xhc3NWYWx1ZVtdKSB7XG4gIHJldHVybiB0d01lcmdlKGNsc3goaW5wdXRzKSk7XG59XG5cbmV4cG9ydCBjb25zdCBmZXRjaGVyID0gYXN5bmMgKHVybDogc3RyaW5nKSA9PiB7XG4gIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2godXJsKTtcblxuICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgbGV0IGRhdGE6IGFueSA9IG51bGw7XG4gICAgbGV0IGZhbGxiYWNrVGV4dDogc3RyaW5nIHwgdW5kZWZpbmVkO1xuXG4gICAgdHJ5IHtcbiAgICAgIGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgfSBjYXRjaCB7XG4gICAgICB0cnkge1xuICAgICAgICBmYWxsYmFja1RleHQgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG4gICAgICB9IGNhdGNoIHtcbiAgICAgICAgZmFsbGJhY2tUZXh0ID0gdW5kZWZpbmVkO1xuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IGNvZGUgPSB0eXBlb2YgZGF0YT8uY29kZSA9PT0gXCJzdHJpbmdcIiA/IChkYXRhLmNvZGUgYXMgc3RyaW5nKSA6IFwiXCI7XG4gICAgY29uc3QgY2F1c2UgPVxuICAgICAgdHlwZW9mIGRhdGE/LmNhdXNlID09PSBcInN0cmluZ1wiXG4gICAgICAgID8gZGF0YS5jYXVzZVxuICAgICAgICA6IHR5cGVvZiBkYXRhPy5tZXNzYWdlID09PSBcInN0cmluZ1wiXG4gICAgICAgICAgPyBkYXRhLm1lc3NhZ2VcbiAgICAgICAgICA6IGZhbGxiYWNrVGV4dDtcblxuICAgIGlmIChjb2RlKSB7XG4gICAgICB0aHJvdyBuZXcgQ2hhdFNES0Vycm9yKGNvZGUgYXMgRXJyb3JDb2RlLCBjYXVzZSk7XG4gICAgfVxuXG4gICAgdGhyb3cgbmV3IENoYXRTREtFcnJvcihcImJhZF9yZXF1ZXN0OmFwaVwiLCBjYXVzZSk7XG4gIH1cblxuICByZXR1cm4gcmVzcG9uc2UuanNvbigpO1xufTtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZldGNoV2l0aEVycm9ySGFuZGxlcnMoXG4gIGlucHV0OiBSZXF1ZXN0SW5mbyB8IFVSTCxcbiAgaW5pdD86IFJlcXVlc3RJbml0LFxuKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChpbnB1dCwgaW5pdCk7XG5cbiAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICBjb25zdCB7IGNvZGUsIGNhdXNlIH0gPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICB0aHJvdyBuZXcgQ2hhdFNES0Vycm9yKGNvZGUgYXMgRXJyb3JDb2RlLCBjYXVzZSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3BvbnNlO1xuICB9IGNhdGNoIChlcnJvcjogdW5rbm93bikge1xuICAgIGlmICh0eXBlb2YgbmF2aWdhdG9yICE9PSAndW5kZWZpbmVkJyAmJiAhbmF2aWdhdG9yLm9uTGluZSkge1xuICAgICAgdGhyb3cgbmV3IENoYXRTREtFcnJvcignb2ZmbGluZTpjaGF0Jyk7XG4gICAgfVxuXG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldExvY2FsU3RvcmFnZShrZXk6IHN0cmluZykge1xuICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICByZXR1cm4gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShrZXkpIHx8ICdbXScpO1xuICB9XG4gIHJldHVybiBbXTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdlbmVyYXRlVVVJRCgpOiBzdHJpbmcge1xuICByZXR1cm4gJ3h4eHh4eHh4LXh4eHgtNHh4eC15eHh4LXh4eHh4eHh4eHh4eCcucmVwbGFjZSgvW3h5XS9nLCAoYykgPT4ge1xuICAgIGNvbnN0IHIgPSAoTWF0aC5yYW5kb20oKSAqIDE2KSB8IDA7XG4gICAgY29uc3QgdiA9IGMgPT09ICd4JyA/IHIgOiAociAmIDB4MykgfCAweDg7XG4gICAgcmV0dXJuIHYudG9TdHJpbmcoMTYpO1xuICB9KTtcbn1cblxudHlwZSBSZXNwb25zZU1lc3NhZ2VXaXRob3V0SWQgPSBUb29sTW9kZWxNZXNzYWdlIHwgQXNzaXN0YW50TW9kZWxNZXNzYWdlO1xudHlwZSBSZXNwb25zZU1lc3NhZ2UgPSBSZXNwb25zZU1lc3NhZ2VXaXRob3V0SWQgJiB7IGlkOiBzdHJpbmcgfTtcblxuZXhwb3J0IGZ1bmN0aW9uIGdldE1vc3RSZWNlbnRVc2VyTWVzc2FnZShtZXNzYWdlczogVUlNZXNzYWdlW10pIHtcbiAgY29uc3QgdXNlck1lc3NhZ2VzID0gbWVzc2FnZXMuZmlsdGVyKChtZXNzYWdlKSA9PiBtZXNzYWdlLnJvbGUgPT09ICd1c2VyJyk7XG4gIHJldHVybiB1c2VyTWVzc2FnZXMuYXQoLTEpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0RG9jdW1lbnRUaW1lc3RhbXBCeUluZGV4KFxuICBkb2N1bWVudHM6IERvY3VtZW50W10sXG4gIGluZGV4OiBudW1iZXIsXG4pIHtcbiAgaWYgKCFkb2N1bWVudHMpIHsgcmV0dXJuIG5ldyBEYXRlKCk7IH1cbiAgaWYgKGluZGV4ID4gZG9jdW1lbnRzLmxlbmd0aCkgeyByZXR1cm4gbmV3IERhdGUoKTsgfVxuXG4gIHJldHVybiBkb2N1bWVudHNbaW5kZXhdLmNyZWF0ZWRBdDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFRyYWlsaW5nTWVzc2FnZUlkKHtcbiAgbWVzc2FnZXMsXG59OiB7XG4gIG1lc3NhZ2VzOiBSZXNwb25zZU1lc3NhZ2VbXTtcbn0pOiBzdHJpbmcgfCBudWxsIHtcbiAgY29uc3QgdHJhaWxpbmdNZXNzYWdlID0gbWVzc2FnZXMuYXQoLTEpO1xuXG4gIGlmICghdHJhaWxpbmdNZXNzYWdlKSB7IHJldHVybiBudWxsOyB9XG5cbiAgcmV0dXJuIHRyYWlsaW5nTWVzc2FnZS5pZDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNhbml0aXplVGV4dCh0ZXh0Pzogc3RyaW5nKTogc3RyaW5nIHtcbiAgaWYgKCF0ZXh0KSByZXR1cm4gXCJcIjtcbiAgcmV0dXJuIHRleHQucmVwbGFjZSgnPGhhc19mdW5jdGlvbl9jYWxsPicsICcnKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvbnZlcnRUb1VJTWVzc2FnZXMobWVzc2FnZXM6IERCTWVzc2FnZVtdKTogQ2hhdE1lc3NhZ2VbXSB7XG4gIHJldHVybiBtZXNzYWdlcy5tYXAoKG1lc3NhZ2UpID0+ICh7XG4gICAgaWQ6IG1lc3NhZ2UuaWQsXG4gICAgcm9sZTogbWVzc2FnZS5yb2xlIGFzICd1c2VyJyB8ICdhc3Npc3RhbnQnIHwgJ3N5c3RlbScsXG4gICAgY29udGVudDogZ2V0VGV4dEZyb21NZXNzYWdlKHsgcGFydHM6IG1lc3NhZ2UucGFydHMgfSBhcyBhbnkpLFxuICAgIHBhcnRzOiBtZXNzYWdlLnBhcnRzIGFzIFVJTWVzc2FnZVBhcnQ8Q3VzdG9tVUlEYXRhVHlwZXMsIENoYXRUb29scz5bXSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgY3JlYXRlZEF0OiBmb3JtYXRJU08obWVzc2FnZS5jcmVhdGVkQXQpLFxuICAgIH0sXG4gIH0pKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFRleHRGcm9tTWVzc2FnZShtZXNzYWdlOiBDaGF0TWVzc2FnZSB8IFVJTWVzc2FnZSk6IHN0cmluZyB7XG4gIHJldHVybiBtZXNzYWdlLnBhcnRzXG4gICAgLmZpbHRlcigocGFydCkgPT4gcGFydC50eXBlID09PSAndGV4dCcpXG4gICAgLm1hcCgocGFydCkgPT4gKHBhcnQgYXMgeyB0eXBlOiAndGV4dCc7IHRleHQ6IHN0cmluZyB9KS50ZXh0KVxuICAgIC5qb2luKCcnKTtcbn1cbiJdLCJuYW1lcyI6WyJjbHN4IiwiZm9ybWF0SVNPIiwidHdNZXJnZSIsIkNoYXRTREtFcnJvciIsImNuIiwiaW5wdXRzIiwiZmV0Y2hlciIsInVybCIsInJlc3BvbnNlIiwiZmV0Y2giLCJvayIsImRhdGEiLCJmYWxsYmFja1RleHQiLCJqc29uIiwidGV4dCIsInVuZGVmaW5lZCIsImNvZGUiLCJjYXVzZSIsIm1lc3NhZ2UiLCJmZXRjaFdpdGhFcnJvckhhbmRsZXJzIiwiaW5wdXQiLCJpbml0IiwiZXJyb3IiLCJuYXZpZ2F0b3IiLCJvbkxpbmUiLCJnZXRMb2NhbFN0b3JhZ2UiLCJrZXkiLCJKU09OIiwicGFyc2UiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwiZ2VuZXJhdGVVVUlEIiwicmVwbGFjZSIsImMiLCJyIiwiTWF0aCIsInJhbmRvbSIsInYiLCJ0b1N0cmluZyIsImdldE1vc3RSZWNlbnRVc2VyTWVzc2FnZSIsIm1lc3NhZ2VzIiwidXNlck1lc3NhZ2VzIiwiZmlsdGVyIiwicm9sZSIsImF0IiwiZ2V0RG9jdW1lbnRUaW1lc3RhbXBCeUluZGV4IiwiZG9jdW1lbnRzIiwiaW5kZXgiLCJEYXRlIiwibGVuZ3RoIiwiY3JlYXRlZEF0IiwiZ2V0VHJhaWxpbmdNZXNzYWdlSWQiLCJ0cmFpbGluZ01lc3NhZ2UiLCJpZCIsInNhbml0aXplVGV4dCIsImNvbnZlcnRUb1VJTWVzc2FnZXMiLCJtYXAiLCJjb250ZW50IiwiZ2V0VGV4dEZyb21NZXNzYWdlIiwicGFydHMiLCJtZXRhZGF0YSIsInBhcnQiLCJ0eXBlIiwiam9pbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/utils.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next@14.1.0_@opentelemetry+_95d5a05ac7ec0d735f17a907e734f3d8","vendor-chunks/ai@3.4.33_react@18.3.1_sswr_af653c0b93f68119aa4870059e5b1a60","vendor-chunks/zod@3.25.76","vendor-chunks/tailwind-merge@2.6.0","vendor-chunks/zod-to-json-schema@3.25.1_zod@3.25.76","vendor-chunks/@ai-sdk+ui-utils@0.0.50_zod@3.25.76","vendor-chunks/date-fns@3.6.0","vendor-chunks/bcrypt-ts@8.0.0","vendor-chunks/@ai-sdk+provider-utils@1.0.22_zod@3.25.76","vendor-chunks/@ai-sdk+provider@0.0.26","vendor-chunks/eventsource-parser@1.1.2","vendor-chunks/secure-json-parse@2.7.0","vendor-chunks/nanoid@3.3.11","vendor-chunks/clsx@2.1.1","vendor-chunks/drizzle-orm@0.45.1_@opentelemetry+api@1.9.0_postgres@3.4.8","vendor-chunks/postgres@3.4.8"], () => (__webpack_exec__("(rsc)/./node_modules/.pnpm/next@14.1.0_@opentelemetry+_95d5a05ac7ec0d735f17a907e734f3d8/node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Froute&page=%2Fapi%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Froute.ts&appDir=E%3A%5C_Projects%5CSentinal-Voice-Assistant%5Cfrontend%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=E%3A%5C_Projects%5CSentinal-Voice-Assistant%5Cfrontend&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();